(window.webpackJsonp=window.webpackJsonp||[]).push([[0],{101:function(e,t,n){e.exports={header:"PowerPlantDetailPage_header__2Oy6X",headerText:"PowerPlantDetailPage_headerText__3xQIM",subHeader:"PowerPlantDetailPage_subHeader__4shvN"}},103:function(e,t,n){e.exports={filter:"EnergyGraph_filter__sXpE0",filterCol:"EnergyGraph_filterCol__3lRs-"}},104:function(e,t,n){e.exports={timestamp:"Labels_timestamp__14xTO",labels:"Labels_labels__3OjBJ",label:"Labels_label__3jxsh"}},134:function(e,t,n){e.exports={component:"App_component__1dd61",footer:"App_footer__29Fsv"}},137:function(e,t,n){e.exports={component:"PlantHeader_component__NDfu0",devices:"PlantHeader_devices__2U2Un"}},140:function(e,t,n){e.exports={component:"BarGraph_component__2Avo8",labels:"BarGraph_labels__3I-cb"}},192:function(e,t,n){e.exports={LinkButton:"LinkButton_LinkButton__38eEK"}},193:function(e,t,n){e.exports={table:"DeviceFilter_table__lKnNt",cell:"DeviceFilter_cell__3_4bz"}},204:function(e,t,n){e.exports={TimeUnitButtons:"TimeUnitButtons_TimeUnitButtons__2HFO5"}},218:function(e,t,n){e.exports=n(383)},22:function(e,t,n){e.exports={filters:"InverterGraphs_filters__3YMN1",dateFilters:"InverterGraphs_dateFilters__3mfAg",graphHeader:"InverterGraphs_graphHeader__20S_9",row:"InverterGraphs_row__Gj9MO",labels:"InverterGraphs_labels__1li5R"}},224:function(e,t,n){},383:function(e,t,n){"use strict";n.r(t);var a=n(0),r=n.n(a),i=n(35),o=n.n(i),c=(n(223),n(224),n(47)),u=n(134),s=n.n(u),l=n(31),d=n(52),m=n(14),h="DIV_SIZE/UPDATE",p={width:0,height:0};var f={updateDivSize:function(e){var t=e.width,n=e.height;return{type:h,width:t,height:n}}},v=n(23),g="FETCH/START",x="FETCH/SUCCESS",y="FETCH/FAIL",b={fetchStart:function(e){var t=e.fetchId;return{type:g,fetchId:t}},fetchSuccess:function(e){var t=e.fetchId,n=e.response;return{type:x,fetchId:t,response:n}},fetchFail:function(e){var t=e.fetchId,n=e.error;return{type:y,fetchId:t,error:n}}},w={fetching:!1,error:"",response:void 0,fetchedAt:"",respondedAt:""};function M(e,t){return e[t]||w}var E={getFetchState:function(e,t){return e[t]||w}},O="BY_ID/UPDATE_ONE",I="BY_ID/UPDATE_MANY",C={updateOne:function(e){var t=e.id,n=e.update;return{type:O,id:t,update:n}},updateMany:function(e){var t=e.update;return{type:I,update:t}}};function A(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case O:var n=t.id,a=t.update;return Object(m.a)({},e,Object(v.a)({},n,a(e[n])));case I:var r=t.update;return Object(m.a)({},e,r(e));default:return e}}var k="CACHE/UPDATE_ONE",F="CACHE/UPDATE_MANY",S={updateOneCache:function(e){var t=e.name,n=e.id,a=e.update;return{type:k,name:t,id:n,update:a}},updateManyCache:function(e){var t=e.name,n=e.update;return{type:F,name:t,update:n}}};var _={getOne:function(e,t,n){return e[t]?e[t][n]:void 0},getMany:function(e,t){return e[t]||{}}},j=Object(d.c)({divSize:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:p,t=arguments.length>1?arguments[1]:void 0;switch(t.type){case h:return Object(m.a)({},e,{width:t.width,height:t.height});default:return e}},fetch:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case g:var n=t.fetchId;return Object(m.a)({},e,Object(v.a)({},n,Object(m.a)({},M(e,n),{fetching:!0,error:""})));case x:var a=t.fetchId,r=t.response,i=(new Date).toISOString();return Object(m.a)({},e,Object(v.a)({},a,Object(m.a)({},M(e,a),{fetching:!1,response:r,fetchedAt:i,respondedAt:i})));case y:var o=t.fetchId,c=t.error,u=(new Date).toISOString();return Object(m.a)({},e,Object(v.a)({},o,Object(m.a)({},M(e,o),{fetching:!1,error:c,fetchedAt:u})));default:return e}},cache:function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{},t=arguments.length>1?arguments[1]:void 0;switch(t.type){case k:var n=t.name,a=t.id,r=t.update;return Object(m.a)({},e,Object(v.a)({},n,A(e[n],C.updateOne({id:a,update:r}))));case F:var i=t.name,o=t.update;return Object(m.a)({},e,Object(v.a)({},i,A(e[i],C.updateMany({update:o}))));default:return e}}}),T={divSize:f,fetch:b,cache:S},D={fetch:E,cache:_};function N(){for(var e=arguments.length,t=new Array(e),n=0;n<e;n++)t[n]=arguments[n];return function(e){return t.slice().reverse().reduce(function(e,t){return t(e)},e)}}function P(e,t,n){var a=!0,r=!1,i=void 0;try{for(var o,c=t[Symbol.iterator]();!(a=(o=c.next()).done);a=!0){var u=o.value;if(void 0==e)break;e=e[u]}}catch(s){r=!0,i=s}finally{try{a||null==c.return||c.return()}finally{if(r)throw i}}return void 0==e?n:e}var L=n(41),H=n(15),R=n.n(H),B=n(24),$=parseInt("-540");function Y(e,t,n){return W.apply(this,arguments)}function W(){return(W=Object(B.a)(R.a.mark(function e(t,n,a){var r,i,o;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,fetch(t,{method:"POST",body:JSON.stringify({query:n,variables:a}),headers:{"Content-Type":"application/json"}});case 2:return r=e.sent,e.next=5,r.text();case 5:if(i=e.sent,e.prev=6,!(o=JSON.parse(i)).errors){e.next=11;break}throw console.error("GraphQL error",o.errors),new Error(o.errors[0].message);case 11:return e.abrupt("return",o);case 14:throw e.prev=14,e.t0=e.catch(6),e.t0;case 17:case"end":return e.stop()}},e,null,[[6,14]])}))).apply(this,arguments)}function z(){return(z=Object(B.a)(R.a.mark(function e(){var t;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"\n    query {\n      powerPlants {\n        count\n        data {\n          id\n          devices {\n            id\n            model\n          }\n        }\n      }\n    }\n  ",e.next=3,Y("https://solar-mesh-energy-logs.ngrok.io","\n    query {\n      powerPlants {\n        count\n        data {\n          id\n          devices {\n            id\n            model\n          }\n        }\n      }\n    }\n  ");case 3:return t=e.sent,e.abrupt("return",t.data.powerPlants);case 5:case"end":return e.stop()}},e)}))).apply(this,arguments)}function U(){return(U=Object(B.a)(R.a.mark(function e(t){var n,a,r;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.id,"\n    query PowerPlant($id: String!) {\n      powerPlant(id: $id) {\n        id\n        devices {\n          id\n          model\n        }\n      }\n    }\n  ",a={id:n},e.next=5,Y("https://solar-mesh-energy-logs.ngrok.io","\n    query PowerPlant($id: String!) {\n      powerPlant(id: $id) {\n        id\n        devices {\n          id\n          model\n        }\n      }\n    }\n  ",a);case 5:return r=e.sent,e.abrupt("return",r.data.powerPlant);case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function q(e){return G.apply(this,arguments)}function G(){return(G=Object(B.a)(R.a.mark(function e(t){var n,a,r,i,o,c,u,s,l,d,m,h,p,f;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"\n    query Energy($plantId: String!, $deviceId: String!, $unit: Unit! $timestamp: TimeZoneRangeInput!) {\n      energy(plantId: $plantId, deviceId: $deviceId, unit: $unit, timestamp: $timestamp) {\n        timestamp\n        energy\n      }\n    }\n  ",n=t.plantId,a=t.deviceId,r=t.unit,i=t.timestamp,o=i.lte,c=i.gte,u={plantId:n,deviceId:a,unit:r,timestamp:{timeZoneOffset:$,lte:o,gte:c}},e.next=5,Y("https://solar-mesh-energy-logs.ngrok.io","\n    query Energy($plantId: String!, $deviceId: String!, $unit: Unit! $timestamp: TimeZoneRangeInput!) {\n      energy(plantId: $plantId, deviceId: $deviceId, unit: $unit, timestamp: $timestamp) {\n        timestamp\n        energy\n      }\n    }\n  ",u);case 5:for(s=e.sent,l=s.data.energy,d=Math.min.apply(Math,Object(L.a)(l.filter(function(e){return e.energy>0}).map(function(e){return e.energy}))),m=0;m<l.length;m++)d=Math.max(d,l[m].energy),0==l[m].energy&&(l[m].energy=d);for(h=[],p=1;p<l.length;p++)f=Math.floor(l[p].energy)-Math.floor(l[p-1].energy),h.push({timestamp:l[p].timestamp,energy:l[p].energy,unixTime:Math.floor(new Date(l[p].timestamp).getTime()/1e3),diff:f}),f<0&&console.warn("Found negative energy diff for plant ".concat(n," device ").concat(a),h);return e.abrupt("return",h);case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}function X(e){return J.apply(this,arguments)}function J(){return(J=Object(B.a)(R.a.mark(function e(t){var n,a,r,i,o;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return n=t.plantId,a=t.yearGte,r=t.yearLte,"\n      query Simulation($plantId: String!, $year: YearRangeInput!) {\n        simulation(plantId: $plantId, year: $year) {\n          year\n          month\n          energy\n        }\n      }\n    ",i={plantId:n,year:{gte:a,lte:r}},e.next=5,Y("https://solar-mesh-energy-logs.ngrok.io","\n      query Simulation($plantId: String!, $year: YearRangeInput!) {\n        simulation(plantId: $plantId, year: $year) {\n          year\n          month\n          energy\n        }\n      }\n    ",i);case 5:return o=e.sent,e.abrupt("return",o.data.simulation.map(function(e){var t=e.year,n=e.month,a=e.energy;return{year:t,month:n,energy:parseFloat(a)}}));case 7:case"end":return e.stop()}},e)}))).apply(this,arguments)}function V(e){return Z.apply(this,arguments)}function Z(){return(Z=Object(B.a)(R.a.mark(function e(t){var n,a,r,i,o,c,u,s;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return"\n    query Logs($plantId: String!, $deviceId: String!, $timestamp: TimestampRangeInput!) {\n      logs(plantId: $plantId, deviceId: $deviceId, timestamp: $timestamp) {\n        timestamp\n        energy\n        power\n        current\n        voltage\n        insulationResistance\n        residualCurrent\n      }\n    }\n  ",n=t.plantId,a=t.deviceId,r=t.lte,i=t.gte,o=t.step,c={plantId:n,deviceId:a,timestamp:{lte:r,gte:i,step:void 0===o?1:o}},e.next=5,Y("https://solar-mesh-energy-logs.ngrok.io","\n    query Logs($plantId: String!, $deviceId: String!, $timestamp: TimestampRangeInput!) {\n      logs(plantId: $plantId, deviceId: $deviceId, timestamp: $timestamp) {\n        timestamp\n        energy\n        power\n        current\n        voltage\n        insulationResistance\n        residualCurrent\n      }\n    }\n  ",c);case 5:return u=e.sent,s=u.data.logs,e.abrupt("return",s.map(function(e){return Object(m.a)({},e,{energy:parseFloat(e.energy),power:parseFloat(e.power),current:parseFloat(e.current),voltage:parseFloat(e.voltage),insulationResistance:parseFloat(e.insulationResistance),residualCurrent:parseFloat(e.residualCurrent),unixTime:Math.floor(new Date(e.timestamp).getTime()/1e3)})}));case 8:case"end":return e.stop()}},e)}))).apply(this,arguments)}var K=n(186),Q=n(18);function ee(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:{},n=t.name,i=void 0===n?"fetch":n,o=t.getFetchId,c=void 0===o?function(e,t){return e}:o,u=t.getParams,s=void 0===u?function(e){return{}}:u,d=t.shouldFetch,m=void 0===d?function(e,t,n){return!0}:d,h=t.saveCache,p=void 0===h?function(e,t,n){}:h,f=t.debounce,g=void 0===f?0:f;return function(t){return Object(l.b)(function(e,t){var n=s(t),a=c(i,n);return D.fetch.getFetchState(e.fetch,a)},T.fetch)(function(n){var o=n.fetching,u=n.error,l=n.response,d=n.fetchedAt,h=n.respondedAt,f=n.fetchStart,x=n.fetchSuccess,y=n.fetchFail,b=Object(K.a)(n,["fetching","error","response","fetchedAt","respondedAt","fetchStart","fetchSuccess","fetchFail"]),w=s(n),M=c(i,w),E=function(e,t){var n=Object(a.useState)(e),r=Object(Q.a)(n,2),i=r[0],o=r[1];return Object(a.useEffect)(function(){var n=setTimeout(function(){o(e)},t);return function(){clearTimeout(n)}},[e]),i}(JSON.stringify(w),g);function O(){return I.apply(this,arguments)}function I(){return(I=Object(B.a)(R.a.mark(function t(){var a;return R.a.wrap(function(t){for(;;)switch(t.prev=t.next){case 0:if(m(n,l,w)){t.next=2;break}return t.abrupt("return");case 2:if(!o){t.next=4;break}return t.abrupt("return");case 4:return f({fetchId:M}),t.prev=5,t.next=8,e(w,n);case 8:a=t.sent,x({fetchId:M,response:a}),p(n,a,w),t.next=16;break;case 13:t.prev=13,t.t0=t.catch(5),y({fetchId:M,error:t.t0.message});case 16:case"end":return t.stop()}},t,null,[[5,13]])}))).apply(this,arguments)}return Object(a.useEffect)(function(){O()},[E]),r.a.createElement(t,Object.assign({},b,Object(v.a)({},i,{fetching:o,error:u,fetch:O,response:l,fetchedAt:d,respondedAt:h,params:w})))})}}var te=n(390),ne=n(391);function ae(e){return e.loading?e.renderLoading():e.error?r.a.createElement(te.a,{negative:!0},r.a.createElement("p",null,e.error),r.a.createElement(ne.a,{onClick:e.onClickRetry},"Retry")):e.children}ae.defaultProps={renderLoading:function(){return r.a.createElement("div",null,"Loading...")}};var re=ae,ie=n(75),oe=n.n(ie),ce=n(1),ue=n.n(ce),se=n(192),le=n.n(se);var de=function(e){var t=e.onClick,n=e.children;return r.a.createElement("button",{className:le.a.LinkButton,onClick:t},n)},me=n(137),he=n.n(me);function pe(e){var t=e.plant,n=e.onClick;return r.a.createElement("div",{className:he.a.component},r.a.createElement(de,{onClick:n},"Plant ",t.id),r.a.createElement("div",{className:he.a.devices},t.devices.length," devices"))}pe.defaultProps={plant:ue.a.shape({id:ue.a.string.isRequired,devices:ue.a.array.isRequired}).isRequired,onClick:ue.a.func.isRequired};var fe=pe,ve=n(17),ge=n(100),xe=n.n(ge);function ye(e){return xe.a.tz(e,"Asia/Tokyo")}function be(e,t,n){var a,r=(a=(e-t)/n,Math.max(Math.floor(Math.log10(Math.abs(a))),0)+1),i=function(e,t){return Math.floor(e/Math.pow(10,t-1)%10)}((e-t)/n,r);return 2*Math.ceil(i/2)*Math.pow(10,r-1)}function we(e){var t=e.width,n=e.height,a=e.backgroundColor;return r.a.createElement("div",{style:{width:t,height:n,backgroundColor:a}})}we.defaultProps={width:ue.a.number.isRequired,height:ue.a.number.isRequired,backgroundColor:ue.a.string.isRequired};var Me=we,Ee=n(66),Oe=n.n(Ee),Ie=1e3,Ce=.5,Ae=12.5,ke=0;function Fe(){return(Fe=Object(B.a)(R.a.mark(function e(t,n){var a,r,i,o,c,u,s,l;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.plantId,r=new Date,i=r.getFullYear(),e.next=5,X({plantId:a,yearGte:i,yearLte:i});case 5:return e.t0=function(e){e.year;return{x:e.month+1,y:e.energy}},o=e.sent.map(e.t0),c=n.plant.devices.find(function(e){return"Cluster Controller"==e.model}),e.next=10,q({plantId:a,deviceId:c.id,unit:"MONTH",timestamp:{gte:ye(r.toISOString()).startOf("year").subtract(1,"month").toISOString(),lte:ye(r.toISOString()).endOf("month").toISOString()}});case 10:return u=e.sent,s=u.map(function(e,t){return Object(m.a)({},e,{x:t+1,y:e.diff})}),l=Math.max.apply(Math,Object(L.a)(s.map(function(e){return e.y})).concat(Object(L.a)(o.map(function(e){return e.y})))),e.abrupt("return",{data:s,yMax:l,simulation:o});case 14:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Se=ee(function(e,t){return Fe.apply(this,arguments)},{name:"getEnergy",getFetchId:function(e,t){return"".concat(e,"-").concat(t.plantId)},getParams:function(e){return{plantId:e.plant.id}},shouldFetch:function(e,t){return!t}})(function(e){var t=e.width,n=e.height,a=e.getEnergy,i=a.fetching,o=a.fetchedAt,c=a.fetch,u=a.error,s=P(a,["response","simulation"],[]),l=P(a,["response","data"],[]),d=Math.max(Ie,P(a,["response","yMax"],0)),m=P(l,[l.length-2,"diff"],0),h=P(l,[l.length-1,"diff"],0),p=be(d,ke,4);return r.a.createElement(re,{loading:i||!o,error:u,onClickRetry:c,renderLoading:function(){return r.a.createElement(Me,{width:t,height:n,backgroundColor:"whitesmoke"})}},r.a.createElement("div",null,r.a.createElement("div",{className:Oe.a.stats},r.a.createElement("div",{className:Oe.a.month},"Last month"," ",r.a.createElement("span",{className:Oe.a.number},m.toLocaleString()," kWh")),r.a.createElement("div",{className:Oe.a.month},"This month"," ",r.a.createElement("span",{className:Oe.a.number},h.toLocaleString()," kWh"))),r.a.createElement(ve.a,{width:t,height:n,backgroundColor:"beige",animate:!1,xMin:Ce,xMax:Ae,yMin:ke,yMax:d,xAxisAt:"bottom",xAxisHeight:20,xAxisLineColor:"lightgrey",xTickInterval:1,xTickLength:5,showXLine:!1,yAxisAt:"right",yAxisWidth:70,yAxisLineColor:"lightgrey",yTickInterval:p,renderYTick:function(e){return"".concat(Math.round(e).toLocaleString()," kWh")},yLabels:[{y:d,width:70,height:20,render:function(e){return"".concat(e.toLocaleString()," kWh")},color:"white",backgroundColor:"blue",drawLine:!0,lineColor:"blue"}],graphs:[{type:"bars",barWidth:16,getBarColor:function(){return"orange"},data:l},{type:"line",data:s,lineColor:"red",step:1}]})))}),_e=10,je=340,Te=210;function De(e){var t=e.width,n=e.plant,a=e.onClick;return r.a.createElement("div",null,r.a.createElement("div",{className:oe.a.plantHeader},r.a.createElement(fe,{plant:n,onClick:a})),r.a.createElement("div",{style:{padding:10,paddingTop:0}},r.a.createElement(Se,{width:t-20,height:Te,plant:n})))}var Ne=N(Object(l.b)(function(e){return{divSize:e.divSize}}),ee(function(){return z.apply(this,arguments)},{name:"getPowerPlants",shouldFetch:function(e,t){return!t}}))(function(e){var t,n=e.divSize,a=e.getPowerPlants,i=(t=n.width)<2*je+2*_e?1:t<3*je+2*_e?2:t<5*je+2*_e?3:5,o=Math.max(Math.floor((n.width-2*_e)/i),je),c=P(a,["response","count"],0),u=P(a,["response","data"],[]);return r.a.createElement(re,{loading:a.fetching||!a.fetchedAt,error:a.error,onClickRetry:a.fetch},r.a.createElement("div",{className:oe.a.count},c," power plants"),r.a.createElement("div",{className:oe.a.col},function(e,t){for(var n=[],a=0;a<e.length;a+=t)n.push(e.slice(a,a+t));return n}(u,i).map(function(t,n){return r.a.createElement("div",{key:n,className:oe.a.row},t.map(function(t){return r.a.createElement(De,{key:t.id,width:o,plant:t,onClick:function(){return e.history.push("/plants/".concat(t.id))}})}))})))}),Pe=["#1CE6FF","#FF34FF","#FF4A46","#008941","#006FA6","#A30059","#FFDBE5","#7A4900","#0000A6","#63FFAC","#B79762","#004D43","#8FB0FF","#997D87","#5A0007","#809693","#1B4400","#4FC601","#3B5DFF","#4A3B53","#FF2F80","#61615A","#BA0900","#6B7900","#00C2A0","#FFAA92","#FF90C9","#B903AA","#D16100","#7B4F4B","#A1C299","#300018","#0AA6D8","#013349","#00846F","#372101","#FFB500","#C2FFED","#A079BF","#CC0744","#C0B9B2","#C2FF99","#00489C","#6F0062","#0CBD66","#EEC3FF","#456D75","#B77B68","#7A87A1","#788D66","#885578","#FAD09F","#FF8A9A","#D157A0","#BEC459","#456648","#0086ED","#886F4C","#34362D","#B4A8BD","#00A6AA","#452C2C","#636375","#A3C8C9","#FF913F","#938A81","#575329","#00FECF","#B05B6F","#8CD0FF","#3B9700","#04F757","#C8A1A1","#1E6E00","#7900D7","#A77500","#6367A9","#A05837","#6B002C","#772600","#D790FF","#9B9700","#549E79","#FFF69F","#72418F","#BC23FF","#99ADC0","#3A2465","#922329","#5B4534","#404E55","#0089A3","#CB7E98","#A4E804","#324E72","#6A3A4C","#83AB58","#D1F7CE","#004B28","#C8D0F6","#A3A489","#806C66","#BF5650","#E83000","#66796D","#DA007C","#FF1A59","#8ADBB4","#5B4E51","#C895C5","#320033","#FF6832","#66E1D3","#CFCDAC","#D0AC94","#7ED379","#012C58"],Le=n(101),He=n.n(Le);function Re(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};return function(t){return function(n){var i=Object(a.useState)(e),o=Object(Q.a)(i,2),c=o[0],u=o[1];return r.a.createElement(t,Object.assign({},n,{params:c,setParams:u}))}}}var Be=n(389),$e=n(388);function Ye(e){var t=e.size,n=e.margin,a=e.color;return r.a.createElement("div",{style:{width:t,height:t,margin:n,backgroundColor:a}})}Ye.defaultProps={color:"red",size:10,margin:5};var We=Ye,ze=n(193),Ue=n.n(ze);function qe(e){var t=e.onClick,n=e.checked,a=e.color,i=e.text;return r.a.createElement(Be.a.Item,{onClick:t},r.a.createElement("div",{className:Ue.a.cell},r.a.createElement($e.a,{checked:!!n}),r.a.createElement(We,{color:a}),r.a.createElement("div",null,i)))}var Ge=function(e){var t=e.devices,n=e.checked,i=e.colors,o=e.onToggle,c=Object(a.useState)(!1),u=Object(Q.a)(c,2),s=u[0],l=u[1];function d(e){"all"==e?o("all",t.map(function(e){return e.id})):o(e)}var m=Object.values(n).filter(function(e){return e}).length,h=m==t.length;return r.a.createElement(ne.a.Group,{basic:!0,size:"small"},r.a.createElement(Be.a,{open:s},r.a.createElement(Be.a.Menu,{style:{maxHeight:200,overflow:"auto"}},r.a.createElement(qe,{onClick:function(){return d("all")},checked:h,color:"transparent",text:"All ".concat(t.length," devices")}),r.a.createElement(Be.a.Divider,null),t.map(function(e,t){return r.a.createElement(qe,{key:t,onClick:function(){return d(e.id)},checked:n[e.id],color:i[e.id],text:"".concat(e.model," - ").concat(e.id)})}))),r.a.createElement(ne.a,{labelPosition:"right",icon:"caret down",content:"Showing ".concat(m," devices"),onClick:function(){return l(!s)}}))};function Xe(e){var t=Object(a.useState)(e.reduce(function(e,t){return e[t]=!0,e},{})),n=Object(Q.a)(t,2),r=n[0],i=n[1];return[r,function(e,t){"all"==e?function(){var e=arguments.length>0&&void 0!==arguments[0]?arguments[0]:[],t=Object.values(r).filter(function(e){return e}).length==e.length;i(t?{}:e.reduce(function(e,t){return e[t]=!0,e},{}))}(t):function(e){i(Object(m.a)({},r,Object(v.a)({},e,!r[e])))}(e)}]}var Je=n(103),Ve=n.n(Je),Ze=n(204),Ke=n.n(Ze),Qe=["MONTH","DAY","HOUR"],et={MONTH:"Month",DAY:"Day",HOUR:"Hour"};var tt=function(e){var t=e.active;return r.a.createElement("div",{className:Ke.a.TimeUnitButtons},Qe.map(function(n){return r.a.createElement(ne.a,{key:n,color:(a=n,a==t?"yellow":void 0),onClick:function(){return e.onClick(n)}},et[n]);var a}))};function nt(e){return function(t){return r.a.createElement(e,Object.assign({},t,{disableScroll:function(){document.body.style.overflow="hidden"},enableScroll:function(){document.body.style.overflow="unset"}}))}}var at=n(104),rt=n.n(at);var it=function(e){var t=e.timestamp,n=e.labels;return r.a.createElement("div",null,r.a.createElement("div",{className:rt.a.timestamp},t),r.a.createElement("div",{className:rt.a.labels},n.map(function(e){return r.a.createElement("div",{key:e.id,className:rt.a.label},r.a.createElement(We,{color:e.color}),r.a.createElement("div",null,e.value))})))},ot=n(140),ct=n.n(ot),ut=Object(ve.f)(Object(ve.d)(ve.c.Graph)),st=ve.e.getLayout,lt=5,dt=5,mt=200,ht=0;function pt(e,t){if(void 0!=t&&!isNaN(t)){var n=new Date;switch(e){case"MONTH":return ye(n.toISOString()).startOf("month").add(Math.round(t),"month").format("YYYY-MM");case"DAY":return ye(n.toISOString()).startOf("day").add(Math.round(t),"day").format("YYYY-MM-DD");case"HOUR":return ye(n.toISOString()).startOf("hour").add(Math.round(t),"hour").format("YYYY-MM-DD HH:mm");default:return}}}function ft(e){return e?"".concat(Math.round(e).toLocaleString()," kWh"):"0 kWh"}var vt,gt=nt(function(e){var t=e.width,n=e.data,i=e.yMaxs,o=e.xs,c=e.loading,u=e.devices,s=e.checked,l=e.colors,d=e.xMin,m=e.xMax,h=e.unit,p=e.onChangeXRange,f=Object(a.useState)({x:void 0,y:void 0}),v=Object(Q.a)(f,2),g=v[0],x=v[1],y=Object(a.useState)({timestamp:void 0,diffs:{}}),b=Object(Q.a)(y,2),w=b[0],M=b[1],E=st({padding:10,width:t,height:mt,xAxisAt:"bottom",xAxisHeight:20,yAxisAt:"right",yAxisWidth:70}).graph,O=u.filter(function(e){return s[e.id]}),I=Math.max.apply(Math,Object(L.a)(O.map(function(e){return i[e.id]})).concat([10])),C=Math.max(lt,Math.floor(E.width/(m-d))-2*dt),A=Math.max(1,Math.floor((m-d)/function(e){switch(e){case"MONTH":return 12;case"DAY":case"HOUR":return 6;default:console.error("Invalid unit ".concat(e))}}(h))),k=be(I,ht,4),F=O.map(function(e){return{type:"bars",barWidth:C,getBarColor:function(){return l[e.id]},data:n[e.id]||[]}});return r.a.createElement("div",{className:ct.a.component},r.a.createElement(ut,{width:t,height:mt,backgroundColor:c?"whitesmoke":"beige",mouse:g,xMin:d,xMax:m,yMin:ht,yMax:I,xAxisAt:"bottom",xAxisHeight:20,xAxisLineColor:"lightgrey",xTickInterval:A,xTickLength:5,renderXTick:function(e){return pt(h,e)},showXLine:!1,yAxisAt:"right",yAxisWidth:70,yAxisLineColor:"lightgrey",yTickInterval:k,yTickLength:5,renderYTick:function(e){return"".concat(Math.round(e).toLocaleString()," kWh")},graphs:F,xLabels:[{x:ve.b.math.getX(E.width,E.left,m,d,g.x),width:100,height:20,render:function(e){return pt(h,e)},color:"white",backgroundColor:"black",lineColor:"black"}],yLabels:[{y:I,width:70,height:20,render:function(e){return ft(e)},color:"black",backgroundColor:"orange",lineColor:"orange"},{y:ve.b.math.getY(E.height,E.top,I,ht,g.y),width:70,height:20,render:function(e){return ft(e)},color:"white",backgroundColor:"black",lineColor:"black"}],onMouseMove:function(t,a,r,i){if(ve.b.math.isInside(r,a)){e.disableScroll(),x(a);var c=ve.b.math.getX(r.width,r.left,m,d,a.x),s=ve.b.math.findNearestIndex(o,c),l=P(n,[P(u,[0,"id"]),s,"timestamp"]);l&&M({timestamp:l,diffs:O.reduce(function(e,t){return e[t.id]=P(n,[t.id,s,"diff"],0),e},{})})}else e.enableScroll(),x({x:void 0,y:void 0}),M({timestamp:void 0,diffs:{}});p(i)},onMouseOut:function(){e.enableScroll(),x({x:void 0,y:void 0}),M({timestamp:void 0,diffs:{}})},onWheel:function(e,t,n,a){p(a)}}),r.a.createElement("div",{className:ct.a.labels},r.a.createElement(it,{timestamp:w.timestamp,labels:O.map(function(e){return{id:e.id,color:l[e.id],value:"".concat(P(w.diffs,[e.id],0)," kWh")}})})))}),xt=xe()().unix(),yt=(vt=xt,xe.a.tz(1e3*vt,"Asia/Tokyo").month());function bt(e){switch(e){case"MONTH":return{xMin:-(yt+.5),xMax:11-(yt+.5)};case"DAY":return{xMin:-30.5,xMax:.5};case"HOUR":return{xMin:-72.5,xMax:.5};default:console.error("Unknown unit ".concat(e))}}function wt(e,t,n){switch(e){case"MONTH":case"DAY":case"HOUR":var a=e.toLowerCase();return ye(t.toISOString()).startOf(a).add(Math.round(n)-1,a).toISOString();default:console.error("Invalid unit ".concat(e))}}function Mt(e,t,n){switch(e){case"MONTH":case"DAY":case"HOUR":var a=e.toLowerCase();return ye(t.toISOString()).startOf(a).add(Math.round(n)+1,a).toISOString();default:console.error("Invalid unit ".concat(e))}}function Et(e,t,n){switch(e){case"MONTH":case"DAY":case"HOUR":var a=e.toLowerCase();return ye(t.toISOString()).endOf(a).add(n,a).unix();default:console.error("Invalid unit ".concat(e))}}function Ot(e){var t=e.xMin,n=e.xMax,a=e.tMin,r=e.tMax,i=e.t,o=(n-t)/(r-a),c=t-o*a;return Math.round(o*i+c)}function It(){return(It=Object(B.a)(R.a.mark(function e(t,n){var a,r,i,o,c,u,s,l,d,h,p,f,v;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.plantId,r=t.deviceIds,i=t.unit,o=t.xMin,c=t.xMax,u=new Date,s=wt(i,u,o),l=Mt(i,u,c),e.next=6,Promise.all(r.map(function(){var e=Object(B.a)(R.a.mark(function e(t){var n;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,q({plantId:a,deviceId:t,unit:i,timestamp:{gte:s,lte:l}});case 2:return n=e.sent,e.abrupt("return",{deviceId:t,data:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:return d=e.sent,h=Et(i,u,parseInt(o)),p=Et(i,u,parseInt(c)),f=d.reduce(function(e,t){var n=t.deviceId,a=t.data;return e[n]=a.map(function(e){return Object(m.a)({},e,{x:Ot({xMin:parseInt(o),xMax:parseInt(c),tMin:h,tMax:p,t:e.unixTime}),y:e.diff})}),e},{}),v=d.reduce(function(e,t){var n=t.deviceId,a=t.data;return e[n]=Math.max.apply(Math,Object(L.a)(a.map(function(e){return e.diff})).concat([0])),e},{}),e.abrupt("return",{data:f,yMaxs:v,xs:P(f,[r[0]],[]).map(function(e){return e.x})});case 12:case"end":return e.stop()}},e)}))).apply(this,arguments)}var Ct=N(Re(Object(m.a)({unit:Qe[0]},bt(Qe[0]))),ee(function(e,t){return It.apply(this,arguments)},{name:"getEnergy",getFetchId:function(e,t){return"".concat(e,"-").concat(t.plantId,"-").concat(t.unit)},debounce:500,getParams:function(e){return{plantId:e.plantId,deviceIds:e.devices.map(function(e){return e.id}),unit:e.params.unit,xMin:e.params.xMin,xMax:e.params.xMax}},saveCache:function(e,t){},shouldFetch:function(){return!0}}))(function(e){var t=e.plantId,n=e.devices,a=e.graphWidth,i=e.colors,o=e.params,c=e.setParams,u=e.getEnergy,s=Xe(n.map(function(e){return e.id})),l=Object(Q.a)(s,2),d=l[0],h=l[1];return r.a.createElement(r.a.Fragment,null,r.a.createElement("div",{className:Ve.a.filter},r.a.createElement("div",{className:Ve.a.filterCol},r.a.createElement(tt,{active:o.unit,onClick:function(e){c(Object(m.a)({},o,{unit:e},bt(e)))}})),r.a.createElement("div",{className:Ve.a.filterCol},r.a.createElement(Ge,{devices:n,checked:d,colors:i,onToggle:h}))),r.a.createElement(gt,Object.assign({plantId:t,devices:n,width:a,checked:d,colors:i,data:P(u.response,["data"],{}),yMaxs:P(u.response,["yMaxs"],{}),xs:P(u.response,["xs"],[]),loading:u.fetching},o,{onChangeXRange:function(e){var t=e.xMin,n=e.xMax;c(Object(m.a)({},o,{xMin:t,xMax:n}))}})))}),At=n(141),kt=n.n(At),Ft=Object(ve.f)(Object(ve.d)(ve.c.Graph)),St=ve.e.getLayout,_t=150;function jt(e){if(void 0!=e&&!isNaN(e))return ye(1e3*e).format("MM DD HH:mm")}function Tt(e,t){return e?"".concat(Math.round(e).toLocaleString()," ").concat(t):"".concat(e," ").concat(t)}var Dt=function(e){var t=e.loading,n=e.width,i=e.lines,o=e.yMin,c=e.yMax,u=e.xMin,s=e.xMax,l=e.mouseX,d=e.unit,m=Object(a.useState)(),h=Object(Q.a)(m,2),p=h[0],f=h[1],v=be(c,o,4),g=i.map(function(e){return{type:"line",data:e.data,lineColor:e.color,step:1}}),x=St({padding:10,width:n,height:_t,xAxisAt:"bottom",xAxisHeight:20,yAxisAt:"right",yAxisWidth:70}).graph,y={x:l,y:p};return r.a.createElement(Ft,{width:n,height:_t,backgroundColor:t?"whitesmoke":"beige",mouse:y,xMin:u,xMax:s,yMin:o,yMax:c,xAxisAt:"bottom",xAxisHeight:20,xAxisLineColor:"lightgrey",xTickInterval:86400,xTickLength:5,renderXTick:jt,showXLine:!0,yAxisAt:"right",yAxisWidth:70,yAxisLineColor:"lightgrey",yTickInterval:v,yTickLength:5,renderYTick:function(e){return Tt(e,d)},graphs:g,xLabels:[{x:ve.b.math.getX(x.width,x.left,s,u,l),width:100,height:20,render:jt,color:"white",backgroundColor:"black",drawLine:!0,lineColor:"black"}],yLabels:[{y:ve.b.math.getY(x.height,x.top,c,o,p),width:70,height:20,render:function(e){return Tt(e,d)},color:"white",backgroundColor:"black",drawLine:!0,lineColor:"black"}],onMouseMove:function(t,n,a,r){ve.b.math.isInside(a,n)?f(n.y):f(),e.onMouseMove(n,a,r)},onMouseOut:function(){f(),e.onMouseOut()},onWheel:function(t,n,a,r){e.onWheel(r)}})},Nt=n(22),Pt=n.n(Nt),Lt=Math.round((new Date).getTime()/1e3-432e3),Ht=Math.round((new Date).getTime()/1e3);function Rt(){return(Rt=Object(B.a)(R.a.mark(function e(t,n){var a,r,i,o,c,u,s,l,d,m,h,p,f,v,g,x,y,b,w,M,E,O,I,C,A,k,F,S;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return a=t.plantId,r=t.deviceIds,i=t.xMin,o=t.xMax,c=new Date(1e3*i).toISOString(),u=new Date(1e3*o).toISOString(),5,e.next=6,Promise.all(r.map(function(){var e=Object(B.a)(R.a.mark(function e(t){var n;return R.a.wrap(function(e){for(;;)switch(e.prev=e.next){case 0:return e.next=2,V({plantId:a,deviceId:t,gte:c,lte:u,step:5});case 2:return n=e.sent,e.abrupt("return",{deviceId:t,data:n});case 4:case"end":return e.stop()}},e)}));return function(t){return e.apply(this,arguments)}}()));case 6:s=e.sent,l=P(s,[0,"data"],[]).map(function(e){return e.unixTime}),d=0,m=0,h=0,p=0,f=0,v={},g=!0,x=!1,y=void 0,e.prev=17,b=s[Symbol.iterator]();case 19:if(g=(w=b.next()).done){e.next=46;break}for(M=w.value,E=M.deviceId,O=M.data,v[E]={power:[],current:[],voltage:[],insulationResistance:[],residualCurrent:[]},I=!0,C=!1,A=void 0,e.prev=27,k=O[Symbol.iterator]();!(I=(F=k.next()).done);I=!0)S=F.value,v[E].power.push({x:S.unixTime,y:S.power}),v[E].current.push({x:S.unixTime,y:S.current}),v[E].voltage.push({x:S.unixTime,y:S.voltage}),v[E].insulationResistance.push({x:S.unixTime,y:S.insulationResistance}),v[E].residualCurrent.push({x:S.unixTime,y:S.residualCurrent}),d=Math.max(S.power,d),m=Math.max(S.current,m),h=Math.max(S.voltage,h),p=Math.max(S.insulationResistance,p),f=Math.max(S.residualCurrent,f);e.next=35;break;case 31:e.prev=31,e.t0=e.catch(27),C=!0,A=e.t0;case 35:e.prev=35,e.prev=36,I||null==k.return||k.return();case 38:if(e.prev=38,!C){e.next=41;break}throw A;case 41:return e.finish(38);case 42:return e.finish(35);case 43:g=!0,e.next=19;break;case 46:e.next=52;break;case 48:e.prev=48,e.t1=e.catch(17),x=!0,y=e.t1;case 52:e.prev=52,e.prev=53,g||null==b.return||b.return();case 55:if(e.prev=55,!x){e.next=58;break}throw y;case 58:return e.finish(55);case 59:return e.finish(52);case 60:return e.abrupt("return",{maxPower:d,maxCurrent:m,maxVoltage:h,maxInsulationResistance:p,maxResidualCurrent:f,logs:v,unixTimes:l});case 61:case"end":return e.stop()}},e,null,[[17,48,52,60],[27,31,35,43],[36,,38,42],[53,,55,59]])}))).apply(this,arguments)}var Bt=N(Object(l.b)(function(e){return{divSize:e.divSize}}),nt,Re({xMin:Lt,xMax:Ht}),ee(function(e,t){return Rt.apply(this,arguments)},{name:"getLogs",getFetchId:function(e,t){return"".concat(e,"-").concat(t.plantId)},debounce:500,getParams:function(e){return{plantId:e.plantId,deviceIds:e.devices.map(function(e){return e.id}),xMin:e.params.xMin,xMax:e.params.xMax}},saveCache:function(e,t){},shouldFetch:function(e,t,n){return!0}}))(function(e){var t=e.plantId,n=e.devices,i=e.graphWidth,o=e.colors,c=e.getLogs,u=e.params,s=e.setParams,l=c.fetching,d=P(c,["response"],{}),h=P(d,["logs"],{}),p=P(d,["unixTimes"],{}),f=P(d,["maxPower"],0),g=P(d,["maxCurrent"],0),x=P(d,["maxVoltage"],0),y=P(d,["maxInsulationResistance"],0),b=P(d,["maxResidualCurrent"],0),w=Xe(n.map(function(e){return e.id})),M=Object(Q.a)(w,2),E=M[0],O=M[1],I=Object(a.useState)(),C=Object(Q.a)(I,2),A=C[0],k=C[1],F=Object(a.useState)({timestamp:void 0,power:{},current:{},voltage:{},insulationResistance:{},residualCurrent:{}}),S=Object(Q.a)(F,2),_=S[0],j=S[1],T=Object(a.useState)({gte:new Date(1e3*Lt),lte:new Date(1e3*Ht)}),D=Object(Q.a)(T,2),N=D[0],L=D[1],H=n.filter(function(e){return E[e.id]});function R(e,t){L(Object(m.a)({},N,Object(v.a)({},e,t)))}function B(t,n,a){if(ve.b.math.isInside(n,t)){e.disableScroll(),k(t.x);var r=a.xMin,i=a.xMax,o=ve.b.math.getX(n.width,n.left,i,r,t.x),c=ve.b.math.findNearestIndex(p,o),l=p[c];if(l){var d={timestamp:new Date(1e3*l).toISOString(),power:{},current:{},voltage:{},insulationResistance:{},residualCurrent:{}},f=!0,v=!1,g=void 0;try{for(var x,y=H[Symbol.iterator]();!(f=(x=y.next()).done);f=!0){var b=x.value;d.power[b.id]=P(h,[b.id,"power",c,"y"],0),d.current[b.id]=P(h,[b.id,"current",c,"y"],0),d.voltage[b.id]=P(h,[b.id,"voltage",c,"y"],0),d.insulationResistance[b.id]=P(h,[b.id,"insulationResistance",c,"y"],0),d.residualCurrent[b.id]=P(h,[b.id,"residualCurrent",c,"y"],0)}}catch(w){v=!0,g=w}finally{try{f||null==y.return||y.return()}finally{if(v)throw g}}j(d)}}else e.enableScroll(),k(),j({timestamp:void 0,power:{},current:{},voltage:{},insulationResistance:{},residualCurrent:{}});s(Object(m.a)({},u,a))}function $(){e.enableScroll(),k(),j({timestamp:void 0,power:{},current:{},voltage:{},insulationResistance:{},residualCurrent:{}})}function Y(e){s(Object(m.a)({},u,e))}var W=u.xMin,z=u.xMax;return r.a.createElement("div",null,r.a.createElement("div",{className:Pt.a.filters},r.a.createElement(Ge,{devices:n,checked:E,colors:o,onToggle:O}),r.a.createElement("div",{className:Pt.a.dateFilters},r.a.createElement(kt.a,{format:"yyyy-MM-dd",value:N.gte,disabled:l,onChange:function(e){return R("gte",e)}}),r.a.createElement("div",null," - "),r.a.createElement(kt.a,{format:"yyyy-MM-dd",value:N.lte,disabled:l,onChange:function(e){return R("lte",e)}})),r.a.createElement(ne.a,{loading:l,onClick:function(){s(Object(m.a)({},u,{xMin:Math.round(N.gte.getTime()/1e3),xMax:Math.round(N.lte.getTime()/1e3)}))}},"Filter")),r.a.createElement("h5",{className:Pt.a.graphHeader},"Power (watts)"),r.a.createElement("div",{className:Pt.a.row},r.a.createElement(Dt,{loading:l,lines:H.map(function(e){return{data:P(h,[e.id,"power"],[]),color:o[e.id]}}),width:i,unit:"watts",yMax:f,yMin:0,xMin:W,xMax:z,mouseX:A,onMouseMove:B,onMouseOut:$,onWheel:Y}),r.a.createElement("div",{className:Pt.a.labels},r.a.createElement(it,{timestamp:_.timestamp,labels:H.map(function(e){return{id:e.id,color:o[e.id],value:"".concat(P(_.power,[e.id],0)," watts")}})}))),r.a.createElement("h5",{className:Pt.a.graphHeader},"Current (amp)"),r.a.createElement("div",{className:Pt.a.row},r.a.createElement(Dt,{loading:l,plantId:t,lines:H.map(function(e){return{data:P(h,[e.id,"current"],[]),color:o[e.id]}}),width:i,unit:"amp",yMax:g,yMin:0,xMin:W,xMax:z,mouseX:A,onMouseMove:B,onMouseOut:$,onWheel:Y}),r.a.createElement("div",{className:Pt.a.labels},r.a.createElement(it,{timestamp:_.timestamp,labels:H.map(function(e){return{id:e.id,color:o[e.id],value:"".concat(P(_.current,[e.id],0)," amp")}})}))),r.a.createElement("h5",{className:Pt.a.graphHeader},"Voltage (v)"),r.a.createElement("div",{className:Pt.a.row},r.a.createElement(Dt,{loading:l,lines:H.map(function(e){return{data:P(h,[e.id,"voltage"],[]),color:o[e.id]}}),width:i,unit:"v",yMax:x,yMin:0,xMin:W,xMax:z,mouseX:A,onMouseMove:B,onMouseOut:$,onWheel:Y}),r.a.createElement("div",{className:Pt.a.labels},r.a.createElement(it,{timestamp:_.timestamp,labels:H.map(function(e){return{id:e.id,color:o[e.id],value:"".concat(P(_.voltage,[e.id],0)," v")}})}))),r.a.createElement("h5",{className:Pt.a.graphHeader},"Insulation Resistance (kOhm)"),r.a.createElement("div",{className:Pt.a.row},r.a.createElement(Dt,{loading:l,lines:H.map(function(e){return{data:P(h,[e.id,"insulationResistance"],[]),color:o[e.id]}}),width:i,unit:"kOhm",yMax:y,yMin:0,xMin:W,xMax:z,mouseX:A,onMouseMove:B,onMouseOut:$,onWheel:Y}),r.a.createElement("div",{className:Pt.a.labels},r.a.createElement(it,{timestamp:_.timestamp,labels:H.map(function(e){return{id:e.id,color:o[e.id],value:"".concat(P(_.insulationResistance,[e.id],0)," kOhm")}})}))),r.a.createElement("h5",{className:Pt.a.graphHeader},"Residual Current (mA)"),r.a.createElement("div",{className:Pt.a.row},r.a.createElement(Dt,{loading:l,lines:H.map(function(e){return{data:P(h,[e.id,"residualCurrent"],[]),color:o[e.id]}}),width:i,unit:"mA",yMax:b,yMin:0,xMin:W,xMax:z,mouseX:A,onMouseMove:B,onMouseOut:$,onWheel:Y}),r.a.createElement("div",{className:Pt.a.labels},r.a.createElement(it,{timestamp:_.timestamp,labels:H.map(function(e){return{id:e.id,color:o[e.id],value:"".concat(P(_.residualCurrent,[e.id],0)," mA")}})}))))}),$t=10,Yt=300,Wt=1200;var zt=N(Object(l.b)(function(e){return{divSize:e.divSize}}),ee(function(e){return function(e){return U.apply(this,arguments)}(e)},{name:"getPowerPlant",getFetchId:function(e,t){return"".concat(e,"-").concat(t.id)},getParams:function(e){return{id:e.match.params.plantId}},shouldFetch:function(e,t){return!t}}))(function(e){var t=e.divSize,n=e.getPowerPlant,a=P(n,["response","devices"],[]),i=a.reduce(function(e,t,n){return e[t.id]=Pe[n],e},{}),o=function(e){var t=arguments.length>1&&void 0!==arguments[1]?arguments[1]:-1/0,n=arguments.length>2&&void 0!==arguments[2]?arguments[2]:1/0;return Math.min(Math.max(e,t),n)}(t.width-2*$t,Yt,Wt);return r.a.createElement("div",null,r.a.createElement("div",{className:He.a.header},r.a.createElement("div",{className:He.a.headerText},"Plant ",e.match.params.plantId),r.a.createElement("div",{className:He.a.subHeader},a.length," devices")),r.a.createElement(re,{loading:n.fetching||!n.fetchedAt,error:n.error,onClickRetry:n.fetch},a.length>0&&r.a.createElement(r.a.Fragment,null,r.a.createElement(Ct,{plantId:e.match.params.plantId,devices:a,graphWidth:o,colors:i}),r.a.createElement(Bt,{plantId:e.match.params.plantId,devices:a.filter(function(e){return"Cluster Controller"!=e.model}),graphWidth:o,colors:i}))))});var Ut,qt=(Ut=function(){return r.a.createElement("div",{className:s.a.component},r.a.createElement("h5",null,"Time zone: ","Asia/Tokyo"),r.a.createElement(c.c,null,r.a.createElement(c.a,{path:"/plants/:plantId",component:zt}),r.a.createElement(c.a,{component:Ne})),r.a.createElement("div",{className:s.a.footer}))},Object(l.b)(void 0,T.divSize)(function(e){var t=Object(a.useRef)();return Object(a.useEffect)(function(){function n(){e.updateDivSize({height:t.current.clientHeight,width:t.current.clientWidth})}return n(),window.addEventListener("resize",n),function(){window.removeEventListener("resize",n)}},[]),r.a.createElement("div",{ref:t},r.a.createElement(Ut,e))}));Boolean("localhost"===window.location.hostname||"[::1]"===window.location.hostname||window.location.hostname.match(/^127(?:\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/));var Gt=n(133),Xt=n(206),Jt=(n(382),[Xt.a]);var Vt=Object(d.d)(j,d.a.apply(void 0,Jt));o.a.render(r.a.createElement(Gt.a,{basename:""},r.a.createElement(l.a,{store:Vt},r.a.createElement(qt,null))),document.getElementById("root")),"serviceWorker"in navigator&&navigator.serviceWorker.ready.then(function(e){e.unregister()})},66:function(e,t,n){e.exports={stats:"FiscalEnergyGraph_stats__3j2T_",month:"FiscalEnergyGraph_month__1qsdS",number:"FiscalEnergyGraph_number__3ViBk"}},75:function(e,t,n){e.exports={count:"HomePage_count__3Q6q8",col:"HomePage_col__33bFf",row:"HomePage_row__i7JCH",plantHeader:"HomePage_plantHeader__26-Kz"}}},[[218,1,2]]]);
//# sourceMappingURL=main.5c655049.chunk.js.map