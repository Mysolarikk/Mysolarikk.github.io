{"version":3,"sources":["App.module.css","pages/HomePage/PlantHeader.module.css","pages/PowerPlantDetailPage/EnergyGraph/BarGraph.module.css","components/LinkButton.module.css","components/DeviceFilter.module.css","pages/PowerPlantDetailPage/EnergyGraph/TimeUnitButtons.module.css","pages/PowerPlantDetailPage/InverterGraphs/index.module.css","reducer/divSize.js","reducer/fetch.js","reducer/byId.js","reducer/cache.js","reducer/energy.js","reducer/energyById.js","reducer/index.js","util/index.js","api.js","components/withFetch.js","components/Loading.js","components/LinkButton.js","pages/HomePage/PlantHeader.js","util/date.js","util/math.js","pages/HomePage/GraphPlaceholder.js","pages/HomePage/FiscalEnergyGraph.js","pages/HomePage/index.js","lib/colors.js","components/withParams.js","components/ColorBox.js","components/DeviceFilter.js","components/useToggle.js","pages/PowerPlantDetailPage/EnergyGraph/TimeUnitButtons.js","components/disableScroll.js","components/Labels.js","pages/PowerPlantDetailPage/EnergyGraph/BarGraph.js","pages/PowerPlantDetailPage/EnergyGraph/index.js","pages/PowerPlantDetailPage/InverterGraphs/LineGraph.js","pages/PowerPlantDetailPage/InverterGraphs/index.js","pages/PowerPlantDetailPage/index.js","App.js","components/withDivSize.js","serviceWorker.js","index.js","pages/HomePage/FiscalEnergyGraph.module.css","pages/HomePage/index.module.css","pages/PowerPlantDetailPage/index.module.css","pages/PowerPlantDetailPage/EnergyGraph/index.module.css","components/Labels.module.css"],"names":["module","exports","component","footer","devices","labels","LinkButton","table","cell","TimeUnitButtons","graphHeader","row","UPDATE","initialState","width","height","actions","updateDivSize","_ref","type","START","SUCCESS","FAIL","fetchStart","fetchId","fetchSuccess","_ref2","response","fetchFail","_ref3","error","INITIAL_FETCH_STATE","fetching","undefined","fetchedAt","respondedAt","getFetchState","state","selectors","UPDATE_ONE","UPDATE_MANY","updateOne","id","update","updateMany","reducer","arguments","length","action","Object","objectSpread","defineProperty","updateOneCache","name","updateManyCache","getOne","getMany","CACHE","cacheEnergy","data","INITIAL_STATE","sortByTimestamp","a","b","unixTime","map","d","i","concat","toConsumableArray","sort","INITIAL_ENERGY_STATE","energy","get","combineReducers","divSize","fetch","now","Date","toISOString","cache","byId","energyById","compose","_len","funcs","Array","_key","val","slice","reverse","reduce","v","f","keys","defaultVal","_iteratorNormalCompletion","_didIteratorError","_iteratorError","_step","_iterator","Symbol","iterator","next","done","key","value","err","return","sendQuery","_callee","url","query","variables","res","text","_res","regenerator_default","wrap","_context","prev","method","body","JSON","stringify","headers","Content-Type","sent","parse","errors","console","Error","message","abrupt","t0","stop","_callee2","_context2","process","powerPlants","_callee3","params","_context3","powerPlant","getEnergy","_x5","_getEnergy","apply","this","_callee4","plantId","deviceId","unit","_params$timestamp","lte","gte","diff","_context4","timestamp","timeZoneOffset","Math","floor","push","getTime","warn","getLogs","_x6","_getLogs","_callee5","_params$step","logs","_context5","step","log","parseFloat","power","current","voltage","insulationResistance","residualCurrent","withFetch","request","_ref$name","_ref$getFetchId","getFetchId","_ref$getParams","getParams","props","_ref$shouldFetch","shouldFetch","_ref$saveCache","saveCache","_ref$debounce","debounce","Component","connect","rest","objectWithoutProperties","paramId","delay","_useState","useState","_useState2","slicedToArray","debouncedVal","setDebouncedVal","useEffect","timer","setTimeout","clearTimeout","useDebounce","_fetch","asyncToGenerator","mark","_response","react_default","createElement","assign","Loading","loading","renderLoading","Message","negative","Button","onClick","onClickRetry","children","defaultProps","className","styles","PlantHeader","plant","components_LinkButton","PropTypes","shape","string","isRequired","array","func","timeZone","str","moment","tz","roundInterval","max","min","numSteps","x","numDigits","log10","abs","lastDigit","n","pow","getDigit","ceil","GraphPlaceholder","backgroundColor","style","number","MIN_Y_MAX","X_MIN","X_MAX","Y_MIN","device","yMax","find","model","api","startOf","subtract","endOf","y","energyLastMonth","energyCurrentMonth","yTickInterval","components_Loading","HomePage_GraphPlaceholder","stats","month","toLocaleString","index_es","animate","xMin","xMax","yMin","xAxisAt","xAxisHeight","xAxisLineColor","xTickInterval","xTickLength","showXLine","yAxisAt","yAxisWidth","yAxisLineColor","renderYTick","round","yLabels","render","color","drawLine","lineColor","graphs","barWidth","getBarColor","PADDING","MIN_GRAPH_WIDTH","GRAPH_HEIGHT","Graph","plantHeader","HomePage_PlantHeader","padding","paddingTop","HomePage_FiscalEnergyGraph","_getPowerPlants","getPowerPlants","numGraphsPerRow","graphWidth","count","col","arr","size","chunks","chunk","plants","history","COLORS","withParams","initialParams","setParams","ColorBox","margin","Row","checked","Dropdown","Item","Checkbox","components_ColorBox","DeviceFilter","colors","onToggle","open","setOpen","values","filter","all","Group","basic","Menu","maxHeight","overflow","Divider","labelPosition","icon","content","useToggle","ids","setState","_toggleAll","_toggle","UNITS","TEXT","MONTH","DAY","HOUR","active","disableScroll","document","enableScroll","Labels","label","zoomable","draggable","ReactCanvasTimeSeries","getLayout","layout","MIN_BAR_WIDTH","BAR_PADDING","HEIGHT","renderXLabel","isNaN","add","format","renderYLabel","yMaxs","xs","onChangeXRange","mouse","setMouse","_useState3","diffs","_useState4","nearest","setNearest","graph","checkedDevices","getNumXTicks","BarGraph_Graph","renderXTick","yTickLength","xLabels","canvas","math","getX","left","getY","top","onMouseMove","e","xRange","isInside","findNearestIndex","onMouseOut","onWheel","components_Labels","getGte","_unit","toLowerCase","getLte","getUnixTimeFromX","unix","getXFromUnixTime","tMin","tMax","t","x0","deviceIds","Promise","_ref5","_x3","parseInt","_ref6","_ref7","_ref8","_ref4","_useToggle","_useToggle2","toggle","Fragment","filterCol","EnergyGraph_TimeUnitButtons","getDefaultXRange","components_DeviceFilter","EnergyGraph_BarGraph","LineGraph","lines","mouseX","mouseY","setMouseY","line","LineGraph_Graph","unixTimes","maxPower","maxCurrent","maxVoltage","maxInsulationResistance","maxResidualCurrent","_iteratorNormalCompletion2","_didIteratorError2","_iteratorError2","_iterator2","_step2","_iteratorNormalCompletion3","_didIteratorError3","_iteratorError3","_iterator3","_step3","finish","t1","repsonse","setMouseX","InverterGraphs_LineGraph","GRAPH_PADDING","MAX_GRAPH_WIDTH","_x4","_getPowerPlant","match","getPowerPlant","Infinity","bound","header","headerText","subHeader","PowerPlantDetailPage_EnergyGraph","PowerPlantDetailPage_InverterGraphs","withDivSize","react_router","path","PowerPlantDetailPage","HomePage","ref","useRef","setDivSize","clientHeight","clientWidth","window","addEventListener","removeEventListener","Boolean","location","hostname","middlewares","thunk","store","createStore","applyMiddleware","ReactDOM","react_router_dom","basename","es","src_App","getElementById","navigator","serviceWorker","ready","then","registration","unregister"],"mappings":"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ACE3M,IAAK8H,EAAM7L,GACX5B,MAAO+S,EACPtF,MAAOA,EACPP,QAAS,kBAAMrC,EAAM0I,QAAQnK,KAAd,WAAA9F,OAA8BmK,EAAM7L,iBC6CpD4R,GAzHA,CACb,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UAEA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,UACA,+BCpHa,SAASC,KAA+B,IAApBC,EAAoB1R,UAAAC,OAAA,QAAAd,IAAAa,UAAA,GAAAA,UAAA,GAAJ,GACjD,OAAO,SAAAoJ,GAOL,OANA,SAAoBP,GAAO,IAAAa,EACGC,mBAAS+H,GADZ9H,EAAAzJ,OAAA0J,GAAA,EAAA1J,CAAAuJ,EAAA,GAClB3D,EADkB6D,EAAA,GACV+H,EADU/H,EAAA,GAGzB,OAAOa,EAAAzJ,EAAA0J,cAACtB,EAADjJ,OAAAwK,OAAA,GAAe9B,EAAf,CAAsB9C,OAAQA,EAAQ4L,UAAWA,+BCJvD,SAASC,GAAS/I,GAAO,IACtBsI,EAAwBtI,EAAxBsI,KAAMU,EAAkBhJ,EAAlBgJ,OAAQhC,EAAUhH,EAAVgH,MAEtB,OACEpF,EAAAzJ,EAAA0J,cAAA,OACE0C,MAAO,CACLpP,MAAOmT,EACPlT,OAAQkT,EACRU,OAAQA,EA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","file":"static/js/main.0b304092.chunk.js","sourcesContent":["// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"App_component__1dd61\",\"footer\":\"App_footer__29Fsv\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"PlantHeader_component__NDfu0\",\"devices\":\"PlantHeader_devices__2U2Un\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"component\":\"BarGraph_component__2Avo8\",\"labels\":\"BarGraph_labels__3I-cb\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"LinkButton\":\"LinkButton_LinkButton__38eEK\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"table\":\"DeviceFilter_table__lKnNt\",\"cell\":\"DeviceFilter_cell__3_4bz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"TimeUnitButtons\":\"TimeUnitButtons_TimeUnitButtons__2HFO5\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"graphHeader\":\"InverterGraphs_graphHeader__20S_9\",\"row\":\"InverterGraphs_row__Gj9MO\",\"labels\":\"InverterGraphs_labels__1li5R\"};","const UPDATE = \"DIV_SIZE/UPDATE\"\n\nconst initialState = {\n  width: 0,\n  height: 0,\n}\n\nexport function reducer(state = initialState, action) {\n  switch (action.type) {\n    case UPDATE:\n      return {\n        ...state,\n        width: action.width,\n        height: action.height,\n      }\n    default:\n      return state\n  }\n}\n\nexport const actions = {\n  updateDivSize: ({ width, height }) => ({ type: UPDATE, width, height }),\n}\n","const START = \"FETCH/START\"\nconst SUCCESS = \"FETCH/SUCCESS\"\nconst FAIL = \"FETCH/FAIL\"\n\nexport const actions = {\n  fetchStart: ({ fetchId }) => ({ type: START, fetchId }),\n  fetchSuccess: ({ fetchId, response }) => ({\n    type: SUCCESS,\n    fetchId,\n    response,\n  }),\n  fetchFail: ({ fetchId, error }) => ({ type: FAIL, fetchId, error }),\n}\n\nconst INITIAL_FETCH_STATE = {\n  fetching: false,\n  error: \"\",\n  response: undefined,\n  fetchedAt: \"\",\n  respondedAt: \"\",\n}\n\nfunction getFetchState(state, fetchId) {\n  return state[fetchId] || INITIAL_FETCH_STATE\n}\n\nexport function reducer(state = {}, action) {\n  switch (action.type) {\n    case START: {\n      const { fetchId } = action\n\n      return {\n        ...state,\n        [fetchId]: {\n          ...getFetchState(state, fetchId),\n          fetching: true,\n          error: \"\",\n        },\n      }\n    }\n    case SUCCESS: {\n      const { fetchId, response } = action\n\n      const now = new Date().toISOString()\n\n      return {\n        ...state,\n        [fetchId]: {\n          ...getFetchState(state, fetchId),\n          fetching: false,\n          response,\n          fetchedAt: now,\n          respondedAt: now,\n        },\n      }\n    }\n    case FAIL: {\n      const { fetchId, error } = action\n\n      const now = new Date().toISOString()\n\n      return {\n        ...state,\n        [fetchId]: {\n          ...getFetchState(state, fetchId),\n          fetching: false,\n          error,\n          fetchedAt: now,\n        },\n      }\n    }\n    default:\n      return state\n  }\n}\n\nexport const selectors = {\n  getFetchState: (state, fetchId) => state[fetchId] || INITIAL_FETCH_STATE,\n}\n","const UPDATE_ONE = \"BY_ID/UPDATE_ONE\"\nconst UPDATE_MANY = \"BY_ID/UPDATE_MANY\"\n\nexport const actions = {\n  updateOne: ({ id, update }) => ({ type: UPDATE_ONE, id, update }),\n  updateMany: ({ update }) => ({ type: UPDATE_MANY, update }),\n}\n\nexport function reducer(state = {}, action) {\n  switch (action.type) {\n    case UPDATE_ONE: {\n      const { id, update } = action\n\n      return {\n        ...state,\n        [id]: update(state[id]),\n      }\n    }\n    case UPDATE_MANY: {\n      const { update } = action\n\n      return {\n        ...state,\n        ...update(state),\n      }\n    }\n    default:\n      return state\n  }\n}\n","import * as byId from \"./byId\"\n\nconst UPDATE_ONE = \"CACHE/UPDATE_ONE\"\nconst UPDATE_MANY = \"CACHE/UPDATE_MANY\"\n\nexport const actions = {\n  updateOneCache: ({ name, id, update }) => ({\n    type: UPDATE_ONE,\n    name,\n    id,\n    update,\n  }),\n  updateManyCache: ({ name, update }) => ({ type: UPDATE_MANY, name, update }),\n}\n\nexport function reducer(state = {}, action) {\n  switch (action.type) {\n    case UPDATE_ONE: {\n      const { name, id, update } = action\n\n      return {\n        ...state,\n        [name]: byId.reducer(\n          state[name],\n          byId.actions.updateOne({ id, update })\n        ),\n      }\n    }\n    case UPDATE_MANY: {\n      const { name, update } = action\n\n      return {\n        ...state,\n        [name]: byId.reducer(state[name], byId.actions.updateMany({ update })),\n      }\n    }\n    default:\n      return state\n  }\n}\n\nexport const selectors = {\n  getOne: (state, name, id) => (state[name] ? state[name][id] : undefined),\n  getMany: (state, name) => state[name] || {},\n}\n","const CACHE = \"ENERGY/CACHE\"\n\nexport const actions = {\n  cacheEnergy: data => ({ type: CACHE, data }),\n}\n\nconst INITIAL_STATE = []\n\nfunction sortByTimestamp(a, b) {\n  return a.unixTime - b.unixTime\n}\n\nexport function reducer(state = INITIAL_STATE, action) {\n  switch (action.type) {\n    case CACHE: {\n      const { data } = action\n\n      return data.map((d, i) =>\n        [...(state[i] || []), ...d].sort(sortByTimestamp)\n      )\n    }\n    default:\n      return state\n  }\n}\n","import * as energy from \"./energy\"\n\nconst CACHE = \"ENERGY_BY_ID/CACHE\"\n\nexport const actions = {\n  cacheEnergy: ({ id, data }) => ({ type: CACHE, id, data }),\n}\n\nconst INITIAL_ENERGY_STATE = energy.reducer(undefined, {})\n\nexport function reducer(state = {}, action) {\n  switch (action.type) {\n    case CACHE: {\n      const { id, data } = action\n      return {\n        ...state,\n        [id]: energy.reducer(state[id], energy.actions.cacheEnergy(data)),\n      }\n    }\n    default:\n      return state\n  }\n}\n\nexport const selectors = {\n  get: (state, id) => state[id] || INITIAL_ENERGY_STATE,\n}\n","import { combineReducers } from \"redux\"\nimport * as divSize from \"./divSize\"\nimport * as fetch from \"./fetch\"\nimport * as cache from \"./cache\"\nimport * as energyById from \"./energyById\"\n\nexport const reducer = combineReducers({\n  divSize: divSize.reducer,\n  fetch: fetch.reducer,\n  cache: cache.reducer,\n  energyById: energyById.reducer,\n})\n\nexport const actions = {\n  divSize: divSize.actions,\n  fetch: fetch.actions,\n  cache: cache.actions,\n  energyById: energyById.actions,\n}\n\nexport const selectors = {\n  fetch: fetch.selectors,\n  cache: cache.selectors,\n  energyById: energyById.selectors,\n}\n","export function compose(...funcs) {\n  return val =>\n    funcs\n      .slice()\n      .reverse()\n      .reduce((v, f) => {\n        return f(v)\n      }, val)\n}\n\nexport function chunk(arr, size) {\n  let chunks = []\n\n  for (let i = 0; i < arr.length; i += size) {\n    chunks.push(arr.slice(i, i + size))\n  }\n\n  return chunks\n}\n\nexport function get(val, keys, defaultVal) {\n  for (let key of keys) {\n    if (val == undefined) {\n      break\n    }\n    val = val[key]\n  }\n\n  if (val == undefined) {\n    return defaultVal\n  }\n\n  return val\n}\n","async function sendQuery(url, query, variables) {\n  const res = await fetch(url, {\n    method: \"POST\",\n    body: JSON.stringify({\n      query,\n      variables,\n    }),\n    headers: {\n      \"Content-Type\": \"application/json\",\n    },\n  })\n\n  const text = await res.text()\n\n  try {\n    const res = JSON.parse(text)\n\n    if (res.errors) {\n      console.error(\"GraphQL error\", res.errors)\n      throw new Error(res.errors[0].message)\n    }\n\n    return res\n  } catch (error) {\n    throw error\n  }\n}\n\nexport async function getPowerPlants() {\n  const query = `\n    query {\n      powerPlants {\n        count\n        data {\n          id\n          devices {\n            id\n            model\n          }\n        }\n      }\n    }\n  `\n\n  const res = await sendQuery(process.env.REACT_APP_POWER_PLANTS_URL, query)\n  return res.data.powerPlants\n}\n\nexport async function getPowerPlant(params) {\n  const { id } = params\n\n  const query = `\n    query PowerPlant($id: String!) {\n      powerPlant(id: $id) {\n        id\n        devices {\n          id\n          model\n        }\n      }\n    }\n  `\n\n  const variables = { id }\n\n  const res = await sendQuery(\n    process.env.REACT_APP_POWER_PLANTS_URL,\n    query,\n    variables\n  )\n  return res.data.powerPlant\n}\n\nexport async function getEnergy(params) {\n  const query = `\n    query Energy($plantId: String!, $deviceId: String!, $unit: Unit! $timestamp: TimeZoneRangeInput!) {\n      energy(plantId: $plantId, deviceId: $deviceId, unit: $unit, timestamp: $timestamp) {\n        timestamp\n        energy\n      }\n    }\n  `\n\n  const {\n    plantId,\n    deviceId,\n    unit,\n    timestamp: { lte, gte },\n  } = params\n\n  const variables = {\n    plantId,\n    deviceId,\n    unit,\n    timestamp: {\n      timeZoneOffset: -540,\n      lte,\n      gte,\n    },\n  }\n\n  const res = await sendQuery(\n    process.env.REACT_APP_ENERGY_LOGS_URL,\n    query,\n    variables\n  )\n  const { energy } = res.data\n\n  let data = []\n  for (let i = 1; i < energy.length; i++) {\n    const diff = Math.floor(energy[i].energy) - Math.floor(energy[i - 1].energy)\n\n    data.push({\n      timestamp: energy[i].timestamp,\n      energy: energy[i].energy,\n      unixTime: Math.floor(new Date(energy[i].timestamp).getTime() / 1000),\n      diff,\n    })\n\n    if (diff < 0) {\n      console.warn(\n        `Found negative energy diff for plant ${plantId} device ${deviceId}`,\n        data\n      )\n    }\n  }\n\n  return data\n}\n\nexport async function getLogs(params) {\n  const query = `\n    query Logs($plantId: String!, $deviceId: String!, $timestamp: TimestampRangeInput!) {\n      logs(plantId: $plantId, deviceId: $deviceId, timestamp: $timestamp) {\n        timestamp\n        energy\n        power\n        current\n        voltage\n        insulationResistance\n        residualCurrent\n      }\n    }\n  `\n\n  const { plantId, deviceId, lte, gte, step = 1 } = params\n\n  const variables = {\n    plantId,\n    deviceId,\n    timestamp: {\n      lte,\n      gte,\n      step,\n    },\n  }\n\n  const res = await sendQuery(\n    process.env.REACT_APP_ENERGY_LOGS_URL,\n    query,\n    variables\n  )\n  const { logs } = res.data\n\n  return logs.map(log => ({\n    ...log,\n    energy: parseFloat(log.energy),\n    power: parseFloat(log.power),\n    current: parseFloat(log.current),\n    voltage: parseFloat(log.voltage),\n    insulationResistance: parseFloat(log.insulationResistance),\n    residualCurrent: parseFloat(log.residualCurrent),\n    unixTime: Math.floor(new Date(log.timestamp).getTime() / 1000),\n  }))\n}\n","import React, { useState, useEffect } from \"react\"\nimport PropTypes from \"prop-types\"\nimport { connect } from \"react-redux\"\nimport { actions, selectors } from \"../reducer\"\n\nfunction useDebounce(val, delay) {\n  const [debouncedVal, setDebouncedVal] = useState(val)\n\n  useEffect(() => {\n    const timer = setTimeout(() => {\n      setDebouncedVal(val)\n    }, delay)\n\n    return () => {\n      clearTimeout(timer)\n    }\n  }, [val])\n\n  return debouncedVal\n}\n\nexport default function withFetch(\n  request,\n  {\n    name = \"fetch\",\n    getFetchId = (name, params) => name,\n    getParams = props => ({}),\n    shouldFetch = (props, response, params) => true,\n    saveCache = (props, response, params) => {},\n    debounce = 0,\n  } = {}\n) {\n  return Component => {\n    function WithFetch(props) {\n      const {\n        fetching,\n        error,\n        response,\n        fetchedAt,\n        respondedAt,\n        fetchStart,\n        fetchSuccess,\n        fetchFail,\n        ...rest\n      } = props\n\n      const params = getParams(props)\n      const fetchId = getFetchId(name, params)\n      const paramId = useDebounce(JSON.stringify(params), debounce)\n\n      async function fetch() {\n        if (!shouldFetch(props, response, params)) {\n          return\n        }\n\n        if (fetching) {\n          return\n        }\n\n        fetchStart({ fetchId })\n\n        try {\n          const response = await request(params, props)\n\n          fetchSuccess({ fetchId, response })\n          saveCache(props, response, params)\n        } catch (error) {\n          fetchFail({ fetchId, error: error.message })\n        }\n      }\n\n      useEffect(() => {\n        fetch()\n      }, [paramId])\n\n      return (\n        <Component\n          {...rest}\n          {...{\n            [name]: {\n              fetching,\n              error,\n              fetch,\n              response,\n              fetchedAt,\n              respondedAt,\n              params,\n            },\n          }}\n        />\n      )\n    }\n\n    WithFetch.propTypes = {\n      fetching: PropTypes.bool.isRequired,\n      error: PropTypes.string.isRequired,\n      response: PropTypes.any,\n      respondedAt: PropTypes.string.isRequired,\n      fetchedAt: PropTypes.string.isRequired,\n      fetchStart: PropTypes.func.isRequired,\n      fetchSuccess: PropTypes.func.isRequired,\n      fetchFail: PropTypes.func.isRequired,\n    }\n\n    return connect(\n      (state, props) => {\n        const params = getParams(props)\n        const fetchId = getFetchId(name, params)\n\n        return selectors.fetch.getFetchState(state.fetch, fetchId)\n      },\n      actions.fetch\n    )(WithFetch)\n  }\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { Message, Button } from \"semantic-ui-react\"\n\nexport function Loading(props) {\n  if (props.loading) {\n    return props.renderLoading()\n  }\n\n  if (props.error) {\n    return (\n      <Message negative>\n        <p>{props.error}</p>\n        <Button onClick={props.onClickRetry}>Retry</Button>\n      </Message>\n    )\n  }\n\n  return props.children\n}\n\nLoading.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  error: PropTypes.string.isRequired,\n  children: PropTypes.node,\n  onClickRetry: PropTypes.func.isRequired,\n  renderLoading: PropTypes.func.isRequired,\n}\n\nLoading.defaultProps = {\n  renderLoading: () => <div>Loading...</div>,\n}\n\nexport default Loading\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport styles from \"./LinkButton.module.css\"\n\nexport function LinkButton(props) {\n  const { onClick, children } = props\n\n  return (\n    <button className={styles.LinkButton} onClick={onClick}>\n      {children}\n    </button>\n  )\n}\n\nLinkButton.propTypes = {\n  onClick: PropTypes.func.isRequired,\n  children: PropTypes.node.isRequired,\n}\n\nexport default LinkButton\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport LinkButton from \"../../components/LinkButton\"\nimport styles from \"./PlantHeader.module.css\"\n\nexport function PlantHeader(props) {\n  const { plant, onClick } = props\n\n  return (\n    <div className={styles.component}>\n      <LinkButton onClick={onClick}>Plant {plant.id}</LinkButton>\n      <div className={styles.devices}>{plant.devices.length} devices</div>\n    </div>\n  )\n}\n\nPlantHeader.defaultProps = {\n  plant: PropTypes.shape({\n    id: PropTypes.string.isRequired,\n    devices: PropTypes.array.isRequired,\n  }).isRequired,\n  onClick: PropTypes.func.isRequired,\n}\n\nexport default PlantHeader\n","import moment from \"moment-timezone\"\n\nexport function timeZone(str) {\n  return moment.tz(str, process.env.REACT_APP_TIME_ZONE)\n}\n","function getNumDigits(x) {\n  return Math.max(Math.floor(Math.log10(Math.abs(x))), 0) + 1\n}\n\nfunction getDigit(x, n) {\n  return Math.floor((x / Math.pow(10, n - 1)) % 10)\n}\n\nexport function roundInterval(max, min, numSteps) {\n  const numDigits = getNumDigits((max - min) / numSteps)\n  const lastDigit = getDigit((max - min) / numSteps, numDigits)\n\n  // mapping from last digit to scale\n  // 9, 10 -> 10\n  // 7, 8 -> 8\n  // ...\n  // 1, 2 -> 1\n  const scale = 2 * Math.ceil(lastDigit / 2)\n  return scale * 10 ** (numDigits - 1)\n}\n\nexport function bound(val, min = -Infinity, max = Infinity) {\n  return Math.min(Math.max(val, min), max)\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\n\nexport function GraphPlaceholder(props) {\n  const { width, height, backgroundColor } = props\n\n  return <div style={{ width, height, backgroundColor }} />\n}\n\nGraphPlaceholder.defaultProps = {\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  backgroundColor: PropTypes.string.isRequired,\n}\n\nexport default GraphPlaceholder\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { Graph } from \"react-canvas-time-series\"\nimport { get } from \"../../util\"\nimport { timeZone } from \"../../util/date\"\nimport { roundInterval } from \"../../util/math\"\nimport * as api from \"../../api\"\nimport withFetch from \"../../components/withFetch\"\nimport Loading from \"../../components/Loading\"\nimport GraphPlaceholder from \"./GraphPlaceholder\"\nimport styles from \"./FiscalEnergyGraph.module.css\"\n\nconst MIN_Y_MAX = 1000\nconst X_MIN = 0.5\nconst X_MAX = 12.5\nconst Y_MIN = 0\n\nexport function FiscalEnergyGraph(props) {\n  const { width, height, getEnergy } = props\n\n  const { fetching, fetchedAt, fetch, error } = getEnergy\n\n  const data = get(getEnergy, [\"response\", \"data\"], [])\n  const yMax = Math.max(MIN_Y_MAX, get(getEnergy, [\"response\", \"yMax\"], 0))\n  const energyLastMonth = get(data, [data.length - 2, \"diff\"], 0)\n  const energyCurrentMonth = get(data, [data.length - 1, \"diff\"], 0)\n\n  const yTickInterval = roundInterval(yMax, Y_MIN, 4)\n\n  return (\n    <Loading\n      loading={fetching || !fetchedAt}\n      error={error}\n      onClickRetry={fetch}\n      renderLoading={() => (\n        <GraphPlaceholder\n          width={width}\n          height={height}\n          backgroundColor=\"whitesmoke\"\n        />\n      )}\n    >\n      <div>\n        <div className={styles.stats}>\n          <div className={styles.month}>\n            Last month{\" \"}\n            <span className={styles.number}>\n              {energyLastMonth.toLocaleString()} kWh\n            </span>\n          </div>\n          <div className={styles.month}>\n            This month{\" \"}\n            <span className={styles.number}>\n              {energyCurrentMonth.toLocaleString()} kWh\n            </span>\n          </div>\n        </div>\n        <Graph\n          width={width}\n          height={height}\n          backgroundColor=\"beige\"\n          animate={false}\n          xMin={X_MIN}\n          xMax={X_MAX}\n          yMin={Y_MIN}\n          yMax={yMax}\n          xAxisAt=\"bottom\"\n          xAxisHeight={20}\n          xAxisLineColor=\"lightgrey\"\n          xTickInterval={1}\n          xTickLength={5}\n          showXLine={false}\n          yAxisAt=\"right\"\n          yAxisWidth={70}\n          yAxisLineColor=\"lightgrey\"\n          yTickInterval={yTickInterval}\n          renderYTick={y => `${Math.round(y).toLocaleString()} kWh`}\n          yLabels={[\n            {\n              y: yMax,\n              width: 70,\n              height: 20,\n              render: y => `${y.toLocaleString()} kWh`,\n              color: \"white\",\n              backgroundColor: \"blue\",\n              drawLine: true,\n              lineColor: \"blue\",\n            },\n          ]}\n          graphs={[\n            {\n              type: \"bars\",\n              barWidth: 16,\n              getBarColor: () => \"orange\",\n              data,\n            },\n          ]}\n        />\n      </div>\n    </Loading>\n  )\n}\n\nFiscalEnergyGraph.propTypes = {\n  width: PropTypes.number.isRequired,\n  height: PropTypes.number.isRequired,\n  getEnergy: PropTypes.shape({\n    fetching: PropTypes.bool.isRequired,\n    error: PropTypes.string.isRequired,\n    fetch: PropTypes.func.isRequired,\n    fetchedAt: PropTypes.string.isRequired,\n    response: PropTypes.shape({\n      data: PropTypes.arrayOf(\n        PropTypes.shape({\n          x: PropTypes.number.isRequired,\n          y: PropTypes.number.isRequired,\n        })\n      ).isRequired,\n      yMax: PropTypes.number.isRequired,\n    }),\n  }),\n}\n\nasync function getEnergy(params, props) {\n  const { plantId } = params\n\n  const now = new Date()\n\n  // Find the first cluster controller\n  const device = props.plant.devices.find(\n    device => device.model == \"Cluster Controller\"\n  )\n\n  const res = await api.getEnergy({\n    plantId,\n    deviceId: device.id,\n    unit: \"MONTH\",\n    timestamp: {\n      // last year December\n      gte: timeZone(now.toISOString())\n        .startOf(\"year\")\n        .subtract(1, \"month\")\n        .toISOString(),\n      // end of current month\n      lte: timeZone(now.toISOString())\n        .endOf(\"month\")\n        .toISOString(),\n      timeZoneOffset: -540,\n    },\n  })\n\n  const data = res.map((energy, i) => ({\n    ...energy,\n    x: i + 1,\n    y: energy.diff,\n  }))\n\n  const yMax = Math.max(...data.map(d => d.y))\n\n  return {\n    data,\n    yMax,\n  }\n}\n\nexport default withFetch(getEnergy, {\n  name: \"getEnergy\",\n  getFetchId: (name, params) => `${name}-${params.plantId}`,\n  getParams: props => ({ plantId: props.plant.id }),\n  shouldFetch: (props, response) => !response,\n})(FiscalEnergyGraph)\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { connect } from \"react-redux\"\nimport { get, compose, chunk } from \"../../util\"\nimport * as api from \"../../api\"\nimport withFetch from \"../../components/withFetch\"\nimport Loading from \"../../components/Loading\"\nimport styles from \"./index.module.css\"\nimport PlantHeader from \"./PlantHeader\"\nimport FiscalEnergyGraph from \"./FiscalEnergyGraph\"\n\nconst PADDING = 10\nconst MIN_GRAPH_WIDTH = 340\nconst GRAPH_HEIGHT = 210\n\nexport function getNumGraphsPerRow(width) {\n  if (width < MIN_GRAPH_WIDTH * 2 + 2 * PADDING) {\n    return 1\n  }\n  if (width < MIN_GRAPH_WIDTH * 3 + 2 * PADDING) {\n    return 2\n  }\n  if (width < MIN_GRAPH_WIDTH * 5 + 2 * PADDING) {\n    return 3\n  }\n\n  return 5\n}\n\nfunction Graph(props) {\n  const { width, plant, onClick } = props\n  const padding = 10\n\n  return (\n    <div>\n      <div className={styles.plantHeader}>\n        <PlantHeader plant={plant} onClick={onClick} />\n      </div>\n      <div style={{ padding, paddingTop: 0 }}>\n        <FiscalEnergyGraph\n          width={width - 2 * padding}\n          height={GRAPH_HEIGHT}\n          plant={plant}\n        />\n      </div>\n    </div>\n  )\n}\n\nexport function HomePage(props) {\n  const { divSize, getPowerPlants } = props\n\n  const numGraphsPerRow = getNumGraphsPerRow(divSize.width)\n  const graphWidth = Math.max(\n    Math.floor((divSize.width - 2 * PADDING) / numGraphsPerRow),\n    MIN_GRAPH_WIDTH\n  )\n\n  const count = get(getPowerPlants, [\"response\", \"count\"], 0)\n  const data = get(getPowerPlants, [\"response\", \"data\"], [])\n\n  return (\n    <Loading\n      loading={getPowerPlants.fetching || !getPowerPlants.fetchedAt}\n      error={getPowerPlants.error}\n      onClickRetry={getPowerPlants.fetch}\n    >\n      <div className={styles.count}>{count} power plants</div>\n      <div className={styles.col}>\n        {chunk(data, numGraphsPerRow).map((plants, i) => (\n          <div key={i} className={styles.row}>\n            {plants.map(plant => (\n              <Graph\n                key={plant.id}\n                width={graphWidth}\n                plant={plant}\n                onClick={() => props.history.push(`/plants/${plant.id}`)}\n              />\n            ))}\n          </div>\n        ))}\n      </div>\n    </Loading>\n  )\n}\n\nHomePage.propTypes = {\n  divSize: PropTypes.shape({\n    height: PropTypes.number.isRequired,\n    width: PropTypes.number.isRequired,\n  }).isRequired,\n  history: PropTypes.shape({\n    push: PropTypes.func.isRequired,\n  }).isRequired,\n  getPowerPlants: PropTypes.shape({\n    error: PropTypes.string.isRequired,\n    fetching: PropTypes.bool.isRequired,\n    fetch: PropTypes.func.isRequired,\n    fetchedAt: PropTypes.string.isRequired,\n    response: PropTypes.shape({\n      data: PropTypes.array.isRequired,\n      count: PropTypes.number.isRequired,\n    }),\n  }).isRequired,\n}\n\nexport default compose(\n  connect(state => ({ divSize: state.divSize })),\n  withFetch(api.getPowerPlants, {\n    name: \"getPowerPlants\",\n    shouldFetch: (props, response) => !response,\n  })\n)(HomePage)\n","const COLORS = [\n  \"#1CE6FF\",\n  \"#FF34FF\",\n  \"#FF4A46\",\n  \"#008941\",\n  \"#006FA6\",\n  \"#A30059\",\n  \"#FFDBE5\",\n  \"#7A4900\",\n  \"#0000A6\",\n  \"#63FFAC\",\n  \"#B79762\",\n  \"#004D43\",\n  \"#8FB0FF\",\n  \"#997D87\",\n  \"#5A0007\",\n  \"#809693\",\n  \"#1B4400\",\n  \"#4FC601\",\n  \"#3B5DFF\",\n  \"#4A3B53\",\n  \"#FF2F80\",\n  \"#61615A\",\n  \"#BA0900\",\n  \"#6B7900\",\n  \"#00C2A0\",\n  \"#FFAA92\",\n  \"#FF90C9\",\n  \"#B903AA\",\n  \"#D16100\",\n  \"#7B4F4B\",\n  \"#A1C299\",\n  \"#300018\",\n  \"#0AA6D8\",\n  \"#013349\",\n  \"#00846F\",\n  \"#372101\",\n  \"#FFB500\",\n  \"#C2FFED\",\n  \"#A079BF\",\n  \"#CC0744\",\n  \"#C0B9B2\",\n  \"#C2FF99\",\n  \"#00489C\",\n  \"#6F0062\",\n  \"#0CBD66\",\n  \"#EEC3FF\",\n  \"#456D75\",\n  \"#B77B68\",\n  \"#7A87A1\",\n  \"#788D66\",\n  \"#885578\",\n  \"#FAD09F\",\n  \"#FF8A9A\",\n  \"#D157A0\",\n  \"#BEC459\",\n  \"#456648\",\n  \"#0086ED\",\n  \"#886F4C\",\n\n  \"#34362D\",\n  \"#B4A8BD\",\n  \"#00A6AA\",\n  \"#452C2C\",\n  \"#636375\",\n  \"#A3C8C9\",\n  \"#FF913F\",\n  \"#938A81\",\n  \"#575329\",\n  \"#00FECF\",\n  \"#B05B6F\",\n  \"#8CD0FF\",\n  \"#3B9700\",\n  \"#04F757\",\n  \"#C8A1A1\",\n  \"#1E6E00\",\n  \"#7900D7\",\n  \"#A77500\",\n  \"#6367A9\",\n  \"#A05837\",\n  \"#6B002C\",\n  \"#772600\",\n  \"#D790FF\",\n  \"#9B9700\",\n  \"#549E79\",\n  \"#FFF69F\",\n  \"#72418F\",\n  \"#BC23FF\",\n  \"#99ADC0\",\n  \"#3A2465\",\n  \"#922329\",\n  \"#5B4534\",\n  \"#404E55\",\n  \"#0089A3\",\n  \"#CB7E98\",\n  \"#A4E804\",\n  \"#324E72\",\n  \"#6A3A4C\",\n  \"#83AB58\",\n  \"#D1F7CE\",\n  \"#004B28\",\n  \"#C8D0F6\",\n  \"#A3A489\",\n  \"#806C66\",\n  \"#BF5650\",\n  \"#E83000\",\n  \"#66796D\",\n  \"#DA007C\",\n  \"#FF1A59\",\n  \"#8ADBB4\",\n  \"#5B4E51\",\n  \"#C895C5\",\n  \"#320033\",\n  \"#FF6832\",\n  \"#66E1D3\",\n  \"#CFCDAC\",\n  \"#D0AC94\",\n  \"#7ED379\",\n  \"#012C58\",\n]\n\nexport default COLORS\n","import React, { useState } from \"react\"\n\nexport default function withParams(initialParams = {}) {\n  return Component => {\n    function WithParams(props) {\n      const [params, setParams] = useState(initialParams)\n\n      return <Component {...props} params={params} setParams={setParams} />\n    }\n\n    return WithParams\n  }\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\n\nexport function ColorBox(props) {\n  const { size, margin, color } = props\n\n  return (\n    <div\n      style={{\n        width: size,\n        height: size,\n        margin: margin,\n        backgroundColor: color,\n      }}\n    />\n  )\n}\n\nColorBox.defaultProps = {\n  color: \"red\",\n  size: 10,\n  margin: 5,\n}\n\nColorBox.propTypes = {\n  color: PropTypes.string.isRequired,\n  size: PropTypes.number.isRequired,\n  margin: PropTypes.number.isRequired,\n}\n\nexport default ColorBox\n","import React, { useState } from \"react\"\nimport PropTypes from \"prop-types\"\nimport { Checkbox, Dropdown, Button } from \"semantic-ui-react\"\nimport ColorBox from \"./ColorBox\"\nimport styles from \"./DeviceFilter.module.css\"\n\nfunction Row(props) {\n  const { onClick, checked, color, text } = props\n\n  return (\n    <Dropdown.Item onClick={onClick}>\n      <div className={styles.cell}>\n        <Checkbox checked={!!checked} />\n        <ColorBox color={color} />\n        <div>{text}</div>\n      </div>\n    </Dropdown.Item>\n  )\n}\n\nexport function DeviceFilter(props) {\n  const { devices, checked, colors, onToggle } = props\n\n  const [open, setOpen] = useState(false)\n\n  function onClick(id) {\n    if (id == \"all\") {\n      onToggle(\"all\", devices.map(({ id }) => id))\n    } else {\n      onToggle(id)\n    }\n  }\n\n  const count = Object.values(checked).filter(v => v).length\n  const all = count == devices.length\n\n  return (\n    <Button.Group basic size=\"small\">\n      <Dropdown open={open}>\n        <Dropdown.Menu style={{ maxHeight: 200, overflow: \"auto\" }}>\n          <Row\n            onClick={() => onClick(\"all\")}\n            checked={all}\n            color=\"transparent\"\n            text={`All ${devices.length} devices`}\n          />\n          <Dropdown.Divider />\n          {devices.map((device, i) => (\n            <Row\n              key={i}\n              onClick={() => onClick(device.id)}\n              checked={checked[device.id]}\n              color={colors[device.id]}\n              text={`${device.model} - ${device.id}`}\n            />\n          ))}\n        </Dropdown.Menu>\n      </Dropdown>\n      <Button\n        labelPosition=\"right\"\n        icon=\"caret down\"\n        content={`Showing ${count} devices`}\n        onClick={() => setOpen(!open)}\n      />\n    </Button.Group>\n  )\n}\n\nDeviceFilter.propTypes = {\n  devices: PropTypes.arrayOf(\n    PropTypes.shape({\n      model: PropTypes.string.isRequired,\n      id: PropTypes.string.isRequired,\n    })\n  ).isRequired,\n  onToggle: PropTypes.func.isRequired,\n  checked: PropTypes.object.isRequired,\n  colors: PropTypes.object.isRequired,\n}\n\nexport default DeviceFilter\n","import { useState } from \"react\"\n\nexport default function useToggle(ids) {\n  const [checked, setState] = useState(\n    ids.reduce((checked, id) => {\n      checked[id] = true\n      return checked\n    }, {})\n  )\n\n  function _toggle(id) {\n    setState({\n      ...checked,\n      [id]: !checked[id],\n    })\n  }\n\n  function _toggleAll(ids = []) {\n    const all = Object.values(checked).filter(v => v).length == ids.length\n\n    if (all) {\n      setState({})\n    } else {\n      setState(\n        ids.reduce((checked, id) => {\n          checked[id] = true\n          return checked\n        }, {})\n      )\n    }\n  }\n\n  function toggle(id, ids) {\n    if (id == \"all\") {\n      _toggleAll(ids)\n    } else {\n      _toggle(id)\n    }\n  }\n\n  return [checked, toggle]\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { Button } from \"semantic-ui-react\"\nimport styles from \"./TimeUnitButtons.module.css\"\n\nexport const UNITS = [\"MONTH\", \"DAY\", \"HOUR\"]\n\nconst TEXT = {\n  MONTH: \"Month\",\n  DAY: \"Day\",\n  HOUR: \"Hour\",\n}\n\nexport function TimeUnitButtons(props) {\n  const { active } = props\n\n  function getColor(key) {\n    return key == active ? \"yellow\" : undefined\n  }\n\n  return (\n    <div className={styles.TimeUnitButtons}>\n      {UNITS.map(unit => (\n        <Button\n          key={unit}\n          color={getColor(unit)}\n          onClick={() => props.onClick(unit)}\n        >\n          {TEXT[unit]}\n        </Button>\n      ))}\n    </div>\n  )\n}\n\nTimeUnitButtons.propTypes = {\n  active: PropTypes.oneOf(UNITS).isRequired,\n  onClick: PropTypes.func.isRequired,\n}\n\nexport default TimeUnitButtons\n","import React from \"react\"\n\nexport default function disableScroll(Component) {\n  function DisableScroll(props) {\n    function disableScroll() {\n      document.body.style.overflow = \"hidden\"\n    }\n\n    function enableScroll() {\n      document.body.style.overflow = \"unset\"\n    }\n\n    return (\n      <Component\n        {...props}\n        disableScroll={disableScroll}\n        enableScroll={enableScroll}\n      />\n    )\n  }\n\n  return DisableScroll\n}\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport ColorBox from \"./ColorBox\"\nimport styles from \"./Labels.module.css\"\n\nexport function Labels(props) {\n  const { timestamp, labels } = props\n\n  return (\n    <div>\n      <div className={styles.timestamp}>{timestamp}</div>\n      <div className={styles.labels}>\n        {labels.map(label => (\n          <div key={label.id} className={styles.label}>\n            <ColorBox color={label.color} />\n            <div>{label.value}</div>\n          </div>\n        ))}\n      </div>\n    </div>\n  )\n}\n\nLabels.propTypes = {\n  timestamp: PropTypes.string.isRequired,\n  labels: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n      color: PropTypes.string.isRequired,\n      value: PropTypes.string.isRequired,\n    })\n  ).isRequired,\n}\n\nexport default Labels\n","import React, { useState } from \"react\"\nimport PropTypes from \"prop-types\"\nimport ReactCanvasTimeSeries, {\n  canvas,\n  layout,\n  zoomable,\n  draggable,\n} from \"react-canvas-time-series\"\nimport { get } from \"../../../util\"\nimport { timeZone } from \"../../../util/date\"\nimport { roundInterval } from \"../../../util/math\"\nimport disableScroll from \"../../../components/disableScroll\"\nimport Labels from \"../../../components/Labels\"\nimport styles from \"./BarGraph.module.css\"\n\nconst Graph = zoomable(draggable(ReactCanvasTimeSeries.Graph))\nconst { getLayout } = layout\n\nconst MIN_BAR_WIDTH = 5\nconst BAR_PADDING = 5\n\nconst HEIGHT = 200\n\nconst Y_MIN = 0\n\nfunction getNumXTicks(unit) {\n  switch (unit) {\n    case \"MONTH\":\n      return 12\n    case \"DAY\":\n      return 6\n    case \"HOUR\":\n      return 6\n    default:\n      console.error(`Invalid unit ${unit}`)\n  }\n}\n\nfunction renderXLabel(unit, x) {\n  if (x == undefined || isNaN(x)) {\n    return\n  }\n\n  const now = new Date()\n\n  switch (unit) {\n    case \"MONTH\":\n      return timeZone(now.toISOString())\n        .startOf(\"month\")\n        .add(Math.round(x), \"month\")\n        .format(\"YYYY-MM\")\n    case \"DAY\":\n      return timeZone(now.toISOString())\n        .startOf(\"day\")\n        .add(Math.round(x), \"day\")\n        .format(\"YYYY-MM-DD\")\n    case \"HOUR\":\n      return timeZone(now.toISOString())\n        .startOf(\"hour\")\n        .add(Math.round(x), \"hour\")\n        .format(\"YYYY-MM-DD HH:mm\")\n    default:\n      return\n  }\n}\n\nfunction renderYLabel(y) {\n  if (!y) {\n    return \"0 kWh\"\n  }\n\n  return `${Math.round(y).toLocaleString()} kWh`\n}\n\nexport function BarGraph(props) {\n  const {\n    width,\n    data,\n    yMaxs,\n    xs,\n    loading,\n    devices,\n    checked,\n    colors,\n    xMin,\n    xMax,\n    unit,\n    onChangeXRange,\n  } = props\n\n  const [mouse, setMouse] = useState({\n    x: undefined,\n    y: undefined,\n  })\n\n  const [nearest, setNearest] = useState({\n    timestamp: undefined,\n    diffs: {},\n  })\n\n  const { graph } = getLayout({\n    padding: 10,\n    width,\n    height: HEIGHT,\n    xAxisAt: \"bottom\",\n    xAxisHeight: 20,\n    yAxisAt: \"right\",\n    yAxisWidth: 70,\n  })\n\n  const checkedDevices = devices.filter(device => checked[device.id])\n  const yMax = Math.max(...checkedDevices.map(device => yMaxs[device.id]), 100)\n\n  function onMouseMove(e, mouse, graph, xRange) {\n    if (canvas.math.isInside(graph, mouse)) {\n      props.disableScroll()\n\n      setMouse(mouse)\n      const x = canvas.math.getX(graph.width, graph.left, xMax, xMin, mouse.x)\n      const i = canvas.math.findNearestIndex(xs, x)\n\n      const timestamp = get(data, [get(devices, [0, \"id\"]), i, \"timestamp\"])\n\n      if (timestamp) {\n        setNearest({\n          timestamp,\n          diffs: checkedDevices.reduce((diffs, device) => {\n            diffs[device.id] = get(data, [device.id, i, \"diff\"], 0)\n            return diffs\n          }, {}),\n        })\n      }\n    } else {\n      props.enableScroll()\n\n      setMouse({\n        x: undefined,\n        y: undefined,\n      })\n\n      setNearest({\n        timestamp: undefined,\n        diffs: {},\n      })\n    }\n\n    onChangeXRange(xRange)\n  }\n\n  function onMouseOut() {\n    props.enableScroll()\n\n    setMouse({\n      x: undefined,\n      y: undefined,\n    })\n\n    setNearest({\n      timestamp: undefined,\n      diffs: {},\n    })\n  }\n\n  function onWheel(e, mouse, graph, xRange) {\n    onChangeXRange(xRange)\n  }\n\n  const barWidth = Math.max(\n    MIN_BAR_WIDTH,\n    Math.floor(graph.width / (xMax - xMin)) - 2 * BAR_PADDING\n  )\n\n  // TODO xTickInterval based on graph.width\n  const xTickInterval = Math.max(\n    1,\n    Math.floor((xMax - xMin) / getNumXTicks(unit))\n  )\n  const yTickInterval = roundInterval(yMax, Y_MIN, 4)\n\n  const graphs = checkedDevices.map(device => ({\n    type: \"bars\",\n    barWidth,\n    getBarColor: () => colors[device.id],\n    data: data[device.id] || [],\n  }))\n\n  return (\n    <div className={styles.component}>\n      <Graph\n        width={width}\n        height={HEIGHT}\n        backgroundColor={loading ? \"whitesmoke\" : \"beige\"}\n        mouse={mouse}\n        xMin={xMin}\n        xMax={xMax}\n        yMin={Y_MIN}\n        yMax={yMax}\n        xAxisAt=\"bottom\"\n        xAxisHeight={20}\n        xAxisLineColor=\"lightgrey\"\n        xTickInterval={xTickInterval}\n        xTickLength={5}\n        renderXTick={x => renderXLabel(unit, x)}\n        showXLine={false}\n        yAxisAt=\"right\"\n        yAxisWidth={70}\n        yAxisLineColor=\"lightgrey\"\n        yTickInterval={yTickInterval}\n        yTickLength={5}\n        renderYTick={y => `${Math.round(y).toLocaleString()} kWh`}\n        graphs={graphs}\n        xLabels={[\n          {\n            x: canvas.math.getX(graph.width, graph.left, xMax, xMin, mouse.x),\n            width: 100,\n            height: 20,\n            render: x => renderXLabel(unit, x),\n            color: \"white\",\n            backgroundColor: \"black\",\n            lineColor: \"black\",\n          },\n        ]}\n        yLabels={[\n          {\n            y: yMax,\n            width: 70,\n            height: 20,\n            render: y => renderYLabel(y),\n            color: \"black\",\n            backgroundColor: \"orange\",\n            lineColor: \"orange\",\n          },\n          {\n            y: canvas.math.getY(graph.height, graph.top, yMax, Y_MIN, mouse.y),\n            width: 70,\n            height: 20,\n            render: y => renderYLabel(y),\n            color: \"white\",\n            backgroundColor: \"black\",\n            lineColor: \"black\",\n          },\n        ]}\n        onMouseMove={onMouseMove}\n        onMouseOut={onMouseOut}\n        onWheel={onWheel}\n      />\n      <div className={styles.labels}>\n        <Labels\n          timestamp={nearest.timestamp}\n          labels={checkedDevices.map(device => ({\n            id: device.id,\n            color: colors[device.id],\n            value: `${get(nearest.diffs, [device.id], 0)} kWh`,\n          }))}\n        />\n      </div>\n    </div>\n  )\n}\n\nBarGraph.propTypes = {\n  width: PropTypes.number.isRequired,\n  data: PropTypes.object.isRequired,\n  yMaxs: PropTypes.object.isRequired,\n  xs: PropTypes.arrayOf(PropTypes.number).isRequired,\n  loading: PropTypes.bool.isRequired,\n  unit: PropTypes.oneOf([\"MONTH\", \"DAY\", \"HOUR\"]),\n  onChangeXRange: PropTypes.func.isRequired,\n  disableScroll: PropTypes.func.isRequired,\n  enableScroll: PropTypes.func.isRequired,\n}\n\nexport default disableScroll(BarGraph)\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { get, compose } from \"../../../util\"\nimport { timeZone } from \"../../../util/date\"\nimport * as api from \"../../../api\"\nimport withFetch from \"../../../components/withFetch\"\nimport withParams from \"../../../components/withParams\"\nimport DeviceFilter from \"../../../components/DeviceFilter\"\nimport useToggle from \"../../../components/useToggle\"\nimport styles from \"./index.module.css\"\nimport TimeUnitButtons, { UNITS } from \"./TimeUnitButtons\"\nimport BarGraph from \"./BarGraph\"\n\nfunction getDefaultXRange(unit) {\n  switch (unit) {\n    case \"MONTH\":\n      return {\n        xMin: -6.5,\n        xMax: 5.5,\n      }\n    case \"DAY\":\n      return {\n        xMin: -30.5,\n        xMax: 0.5,\n      }\n    case \"HOUR\":\n      return {\n        xMin: -72.5,\n        xMax: 0.5,\n      }\n    default:\n      throw new Error(`Unknown unit ${unit}`)\n  }\n}\n\nexport function EnergyGraph(props) {\n  const {\n    plantId,\n    devices,\n    graphWidth,\n    colors,\n    params,\n    setParams,\n    getEnergy,\n  } = props\n\n  const [checked, toggle] = useToggle(devices.map(({ id }) => id))\n\n  function onClickTimeUnitButton(unit) {\n    setParams({\n      ...params,\n      unit,\n      ...getDefaultXRange(unit),\n    })\n  }\n\n  function onChangeXRange({ xMin, xMax }) {\n    setParams({\n      ...params,\n      xMin,\n      xMax,\n    })\n  }\n\n  return (\n    <>\n      <div className={styles.filter}>\n        <div className={styles.filterCol}>\n          <TimeUnitButtons\n            active={params.unit}\n            onClick={onClickTimeUnitButton}\n          />\n        </div>\n        <div className={styles.filterCol}>\n          <DeviceFilter\n            devices={devices}\n            checked={checked}\n            colors={colors}\n            onToggle={toggle}\n          />\n        </div>\n      </div>\n      <BarGraph\n        plantId={plantId}\n        devices={devices}\n        width={graphWidth}\n        checked={checked}\n        colors={colors}\n        data={get(getEnergy.response, [\"data\"], {})}\n        yMaxs={get(getEnergy.response, [\"yMaxs\"], {})}\n        xs={get(getEnergy.response, [\"xs\"], [])}\n        loading={getEnergy.fetching}\n        {...params}\n        onChangeXRange={onChangeXRange}\n      />\n    </>\n  )\n}\n\nEnergyGraph.propTypes = {\n  plantId: PropTypes.string.isRequired,\n  graphWidth: PropTypes.number.isRequired,\n  devices: PropTypes.arrayOf(\n    PropTypes.shape({\n      id: PropTypes.string.isRequired,\n    })\n  ).isRequired,\n  colors: PropTypes.object.isRequired,\n  params: PropTypes.shape({\n    unit: PropTypes.oneOf(UNITS).isRequired,\n    xMin: PropTypes.number.isRequired,\n    xMax: PropTypes.number.isRequired,\n  }).isRequired,\n  setParams: PropTypes.func.isRequired,\n  getEnergy: PropTypes.shape({\n    fetching: PropTypes.bool.isRequired,\n  }).isRequired,\n}\n\nfunction getGte(unit, now, x) {\n  switch (unit) {\n    case \"MONTH\":\n    case \"DAY\":\n    case \"HOUR\":\n      const _unit = unit.toLowerCase()\n\n      return timeZone(now.toISOString())\n        .startOf(_unit)\n        .add(Math.round(x) - 1, _unit)\n        .toISOString()\n    default:\n      console.error(`Invalid unit ${unit}`)\n  }\n}\n\nfunction getLte(unit, now, x) {\n  switch (unit) {\n    case \"MONTH\":\n    case \"DAY\":\n    case \"HOUR\":\n      const _unit = unit.toLowerCase()\n\n      return timeZone(now.toISOString())\n        .startOf(_unit)\n        .add(Math.round(x) + 1, _unit)\n        .toISOString()\n    default:\n      console.error(`Invalid unit ${unit}`)\n  }\n}\n\nfunction getUnixTimeFromX(unit, now, x) {\n  switch (unit) {\n    case \"MONTH\":\n    case \"DAY\":\n    case \"HOUR\":\n      const _unit = unit.toLowerCase()\n\n      return timeZone(now.toISOString())\n        .endOf(_unit)\n        .add(x, _unit)\n        .unix()\n    default:\n      console.error(`Invalid unit ${unit}`)\n  }\n}\n\nfunction getXFromUnixTime({ xMin, xMax, tMin, tMax, t }) {\n  const d = (xMax - xMin) / (tMax - tMin)\n  const x0 = xMin - d * tMin\n\n  return Math.round(d * t + x0)\n}\n\nasync function getEnergy(params, props) {\n  const { plantId, deviceIds, unit, xMin, xMax } = params\n\n  const now = new Date()\n\n  const res = await Promise.all(\n    deviceIds.map(async deviceId => {\n      const data = await api.getEnergy({\n        plantId,\n        deviceId,\n        unit,\n        timestamp: {\n          gte: getGte(unit, now, xMin),\n          lte: getLte(unit, now, xMax),\n          timeZoneOffset: -540,\n        },\n      })\n\n      return {\n        deviceId,\n        data,\n      }\n    })\n  )\n\n  const tMin = getUnixTimeFromX(unit, now, parseInt(xMin))\n  const tMax = getUnixTimeFromX(unit, now, parseInt(xMax))\n\n  const data = res.reduce((map, { deviceId, data }) => {\n    map[deviceId] = data.map(d => ({\n      ...d,\n      x: getXFromUnixTime({\n        xMin: parseInt(xMin),\n        xMax: parseInt(xMax),\n        tMin,\n        tMax,\n        t: d.unixTime,\n      }),\n      y: d.diff,\n    }))\n\n    return map\n  }, {})\n\n  const yMaxs = res.reduce((yMaxs, { deviceId, data }) => {\n    yMaxs[deviceId] = Math.max(...data.map(d => d.diff), 0)\n\n    return yMaxs\n  }, {})\n\n  return {\n    data,\n    yMaxs,\n    xs: get(data, [deviceIds[0]], []).map(({ x }) => x),\n  }\n}\n\nexport default compose(\n  withParams({\n    unit: UNITS[0],\n    xMin: -6.5,\n    xMax: 5.5,\n  }),\n  withFetch(getEnergy, {\n    name: \"getEnergy\",\n    getFetchId: (name, params) => `${name}-${params.plantId}-${params.unit}`,\n    debounce: 500,\n    getParams: props => ({\n      plantId: props.plantId,\n      deviceIds: props.devices.map(({ id }) => id),\n      unit: props.params.unit,\n      xMin: props.params.xMin,\n      xMax: props.params.xMax,\n    }),\n    saveCache: (props, response) => {\n      // props.cacheEnergy({\n      //   id: getCacheId(props),\n      //   data: response,\n      // })\n    },\n    shouldFetch: () => true,\n    // shouldFetch: (props, response, params) => {\n    //   const {\n    //     energy: { data },\n    //   } = props\n    //\n    //   const { unit, xMin, xMax } = params\n    //\n    //   const now = new Date()\n    //   const tMin = getUnixTimeFromX(unit, now, parseInt(xMin))\n    //   const tMax = getUnixTimeFromX(unit, now, parseInt(xMax))\n    //\n    //   return (\n    //     data.length == 0 ||\n    //     tMin < data[0].unixTime ||\n    //     tMax > data[data.length - 1].unixTime\n    //   )\n    // },\n  })\n)(EnergyGraph)\n","import React, { useState } from \"react\"\nimport PropTypes from \"prop-types\"\nimport ReactCanvasTimeSeries, {\n  canvas,\n  zoomable,\n  draggable,\n  layout,\n} from \"react-canvas-time-series\"\nimport { roundInterval } from \"../../../util/math\"\nimport { timeZone } from \"../../../util/date\"\n\nconst Graph = zoomable(draggable(ReactCanvasTimeSeries.Graph))\nconst { getLayout } = layout\n\nconst HEIGHT = 150\n\nfunction renderXLabel(x) {\n  if (x == undefined || isNaN(x)) {\n    return\n  }\n\n  return timeZone(x * 1000).format(\"MM DD HH:mm\")\n}\n\nfunction renderYLabel(y, unit) {\n  if (!y) {\n    return `${y} ${unit}`\n  }\n\n  return `${Math.round(y).toLocaleString()} ${unit}`\n}\n\nexport function LineGraph(props) {\n  const { loading, width, lines, yMin, yMax, xMin, xMax, mouseX, unit } = props\n\n  const [mouseY, setMouseY] = useState()\n\n  function onMouseMove(e, mouse, graph, xRange) {\n    if (canvas.math.isInside(graph, mouse)) {\n      setMouseY(mouse.y)\n    } else {\n      setMouseY()\n    }\n\n    props.onMouseMove(mouse, graph, xRange)\n  }\n\n  function onMouseOut() {\n    setMouseY()\n    props.onMouseOut()\n  }\n\n  function onWheel(e, mouse, graph, xRange) {\n    props.onWheel(xRange)\n  }\n\n  const xTickInterval = 24 * 3600\n  const yTickInterval = roundInterval(yMax, yMin, 4)\n\n  const graphs = lines.map(line => ({\n    type: \"line\",\n    data: line.data,\n    lineColor: line.color,\n    step: 1,\n  }))\n\n  const { graph } = getLayout({\n    padding: 10,\n    width,\n    height: HEIGHT,\n    xAxisAt: \"bottom\",\n    xAxisHeight: 20,\n    yAxisAt: \"right\",\n    yAxisWidth: 70,\n  })\n\n  const mouse = {\n    x: mouseX,\n    y: mouseY,\n  }\n\n  return (\n    <Graph\n      width={width}\n      height={HEIGHT}\n      backgroundColor={loading ? \"whitesmoke\" : \"beige\"}\n      mouse={mouse}\n      xMin={xMin}\n      xMax={xMax}\n      yMin={yMin}\n      yMax={yMax}\n      xAxisAt=\"bottom\"\n      xAxisHeight={20}\n      xAxisLineColor=\"lightgrey\"\n      xTickInterval={xTickInterval}\n      xTickLength={5}\n      renderXTick={renderXLabel}\n      showXLine={true}\n      yAxisAt=\"right\"\n      yAxisWidth={70}\n      yAxisLineColor=\"lightgrey\"\n      yTickInterval={yTickInterval}\n      yTickLength={5}\n      renderYTick={y => renderYLabel(y, unit)}\n      graphs={graphs}\n      xLabels={[\n        {\n          x: canvas.math.getX(graph.width, graph.left, xMax, xMin, mouseX),\n          width: 100,\n          height: 20,\n          render: renderXLabel,\n          color: \"white\",\n          backgroundColor: \"black\",\n          drawLine: true,\n          lineColor: \"black\",\n        },\n      ]}\n      yLabels={[\n        {\n          y: canvas.math.getY(graph.height, graph.top, yMax, yMin, mouseY),\n          width: 70,\n          height: 20,\n          render: y => renderYLabel(y, unit),\n          color: \"white\",\n          backgroundColor: \"black\",\n          drawLine: true,\n          lineColor: \"black\",\n        },\n      ]}\n      onMouseMove={onMouseMove}\n      onMouseOut={onMouseOut}\n      onWheel={onWheel}\n    />\n  )\n}\n\nLineGraph.propTypes = {\n  loading: PropTypes.bool.isRequired,\n  width: PropTypes.number.isRequired,\n  xMin: PropTypes.number.isRequired,\n  xMax: PropTypes.number.isRequired,\n  mouseX: PropTypes.number,\n  lines: PropTypes.arrayOf(\n    PropTypes.shape({\n      color: PropTypes.string.isRequired,\n      data: PropTypes.shape({\n        x: PropTypes.number.isRequired,\n        y: PropTypes.number.isRequired,\n      }).isRequired,\n    })\n  ).isRequired,\n  unit: PropTypes.oneOf([\"watts\", \"amp\", \"v\", \"kOhm\"]).isRequired,\n}\n\nexport default LineGraph\n","import React, { useState } from \"react\"\nimport PropTypes from \"prop-types\"\nimport { canvas } from \"react-canvas-time-series\"\nimport { connect } from \"react-redux\"\nimport { get, compose } from \"../../../util\"\nimport * as api from \"../../../api\"\nimport withParams from \"../../../components/withParams\"\nimport withFetch from \"../../../components/withFetch\"\nimport disableScroll from \"../../../components/disableScroll\"\nimport useToggle from \"../../../components/useToggle\"\nimport DeviceFilter from \"../../../components/DeviceFilter\"\nimport Labels from \"../../../components/Labels\"\nimport LineGraph from \"./LineGraph\"\nimport styles from \"./index.module.css\"\n\nconst X_MIN = Math.round(new Date().getTime() / 1000 - 5 * 24 * 3600)\nconst X_MAX = Math.round(new Date().getTime() / 1000)\n\n// const NOW = Math.round(new Date().getTime() / 1000)\n// const X_MIN = NOW - 9 * 24 * 3600\n// const X_MAX = NOW + 24 * 3600\n\nexport function InverterGraphs(props) {\n  const {\n    plantId,\n    devices,\n    graphWidth,\n    colors,\n    getLogs,\n    params,\n    setParams,\n  } = props\n\n  const { fetching } = getLogs\n\n  const data = get(getLogs, [\"response\"], {})\n  const logs = get(data, [\"logs\"], {})\n  const unixTimes = get(data, [\"unixTimes\"], {})\n\n  const maxPower = get(data, [\"maxPower\"], 0)\n  const maxCurrent = get(data, [\"maxCurrent\"], 0)\n  const maxVoltage = get(data, [\"maxVoltage\"], 0)\n  const maxInsulationResistance = get(data, [\"maxInsulationResistance\"], 0)\n  const maxResidualCurrent = get(data, [\"maxResidualCurrent\"], 0)\n\n  const [checked, toggle] = useToggle(devices.map(({ id }) => id))\n\n  const [mouseX, setMouseX] = useState()\n\n  const [nearest, setNearest] = useState({\n    timestamp: undefined,\n    power: {},\n    current: {},\n    voltage: {},\n    insulationResistance: {},\n    residualCurrent: {},\n  })\n\n  const checkedDevices = devices.filter(device => checked[device.id])\n\n  function onMouseMove(mouse, graph, xRange) {\n    if (canvas.math.isInside(graph, mouse)) {\n      props.disableScroll()\n\n      setMouseX(mouse.x)\n\n      const { xMin, xMax } = xRange\n\n      const x = canvas.math.getX(graph.width, graph.left, xMax, xMin, mouse.x)\n      const i = canvas.math.findNearestIndex(unixTimes, x)\n\n      const unixTime = unixTimes[i]\n\n      if (unixTime) {\n        const nearest = {\n          timestamp: new Date(unixTime * 1000).toISOString(),\n          power: {},\n          current: {},\n          voltage: {},\n          insulationResistance: {},\n          residualCurrent: {},\n        }\n\n        for (const device of checkedDevices) {\n          nearest.power[device.id] = get(logs, [device.id, \"power\", i, \"y\"], 0)\n          nearest.current[device.id] = get(\n            logs,\n            [device.id, \"current\", i, \"y\"],\n            0\n          )\n          nearest.voltage[device.id] = get(\n            logs,\n            [device.id, \"voltage\", i, \"y\"],\n            0\n          )\n          nearest.insulationResistance[device.id] = get(\n            logs,\n            [device.id, \"insulationResistance\", i, \"y\"],\n            0\n          )\n          nearest.residualCurrent[device.id] = get(\n            logs,\n            [device.id, \"residualCurrent\", i, \"y\"],\n            0\n          )\n        }\n\n        setNearest(nearest)\n      }\n    } else {\n      props.enableScroll()\n\n      setMouseX()\n\n      setNearest({\n        timestamp: undefined,\n        power: {},\n        current: {},\n        voltage: {},\n        insulationResistance: {},\n        residualCurrent: {},\n      })\n    }\n\n    setParams({\n      ...params,\n      ...xRange,\n    })\n  }\n\n  function onMouseOut() {\n    props.enableScroll()\n\n    setMouseX()\n\n    setNearest({\n      timestamp: undefined,\n      power: {},\n      current: {},\n      voltage: {},\n      insulationResistance: {},\n      residualCurrent: {},\n    })\n  }\n\n  function onWheel(xRange) {\n    setParams({\n      ...params,\n      ...xRange,\n    })\n  }\n\n  const { xMin, xMax } = params\n\n  // TODO residualCurrent (mA)\n\n  return (\n    <div>\n      <DeviceFilter\n        devices={devices}\n        checked={checked}\n        colors={colors}\n        onToggle={toggle}\n      />\n      <h5 className={styles.graphHeader}>Power (watts)</h5>\n      <div className={styles.row}>\n        <LineGraph\n          loading={fetching}\n          lines={checkedDevices.map(device => ({\n            data: get(logs, [device.id, \"power\"], []),\n            color: colors[device.id],\n          }))}\n          width={graphWidth}\n          unit=\"watts\"\n          yMax={maxPower}\n          yMin={0}\n          xMin={xMin}\n          xMax={xMax}\n          mouseX={mouseX}\n          onMouseMove={onMouseMove}\n          onMouseOut={onMouseOut}\n          onWheel={onWheel}\n        />\n        <div className={styles.labels}>\n          <Labels\n            timestamp={nearest.timestamp}\n            labels={checkedDevices.map(device => ({\n              id: device.id,\n              color: colors[device.id],\n              value: `${get(nearest.power, [device.id], 0)} watts`,\n            }))}\n          />\n        </div>\n      </div>\n\n      <h5 className={styles.graphHeader}>Current (amp)</h5>\n      <div className={styles.row}>\n        <LineGraph\n          loading={fetching}\n          plantId={plantId}\n          lines={checkedDevices.map(device => ({\n            data: get(logs, [device.id, \"current\"], []),\n            color: colors[device.id],\n          }))}\n          width={graphWidth}\n          unit=\"amp\"\n          yMax={maxCurrent}\n          yMin={0}\n          xMin={xMin}\n          xMax={xMax}\n          mouseX={mouseX}\n          onMouseMove={onMouseMove}\n          onMouseOut={onMouseOut}\n          onWheel={onWheel}\n        />\n        <div className={styles.labels}>\n          <Labels\n            timestamp={nearest.timestamp}\n            labels={checkedDevices.map(device => ({\n              id: device.id,\n              color: colors[device.id],\n              value: `${get(nearest.current, [device.id], 0)} amp`,\n            }))}\n          />\n        </div>\n      </div>\n\n      <h5 className={styles.graphHeader}>Voltage (v)</h5>\n      <div className={styles.row}>\n        <LineGraph\n          loading={fetching}\n          lines={checkedDevices.map(device => ({\n            data: get(logs, [device.id, \"voltage\"], []),\n            color: colors[device.id],\n          }))}\n          width={graphWidth}\n          unit=\"v\"\n          yMax={maxVoltage}\n          yMin={0}\n          xMin={xMin}\n          xMax={xMax}\n          mouseX={mouseX}\n          onMouseMove={onMouseMove}\n          onMouseOut={onMouseOut}\n          onWheel={onWheel}\n        />\n        <div className={styles.labels}>\n          <Labels\n            timestamp={nearest.timestamp}\n            labels={checkedDevices.map(device => ({\n              id: device.id,\n              color: colors[device.id],\n              value: `${get(nearest.voltage, [device.id], 0)} v`,\n            }))}\n          />\n        </div>\n      </div>\n\n      <h5 className={styles.graphHeader}>Insulation Resistance (kOhm)</h5>\n      <div className={styles.row}>\n        <LineGraph\n          loading={fetching}\n          lines={checkedDevices.map(device => ({\n            data: get(logs, [device.id, \"insulationResistance\"], []),\n            color: colors[device.id],\n          }))}\n          width={graphWidth}\n          unit=\"kOhm\"\n          yMax={maxInsulationResistance}\n          yMin={0}\n          xMin={xMin}\n          xMax={xMax}\n          mouseX={mouseX}\n          onMouseMove={onMouseMove}\n          onMouseOut={onMouseOut}\n          onWheel={onWheel}\n        />\n        <div className={styles.labels}>\n          <Labels\n            timestamp={nearest.timestamp}\n            labels={checkedDevices.map(device => ({\n              id: device.id,\n              color: colors[device.id],\n              value: `${get(\n                nearest.insulationResistance,\n                [device.id],\n                0\n              )} kOhm`,\n            }))}\n          />\n        </div>\n      </div>\n\n      <h5 className={styles.graphHeader}>Residual Current (mA)</h5>\n      <div className={styles.row}>\n        <LineGraph\n          loading={fetching}\n          lines={checkedDevices.map(device => ({\n            data: get(logs, [device.id, \"residualCurrent\"], []),\n            color: colors[device.id],\n          }))}\n          width={graphWidth}\n          unit=\"mA\"\n          yMax={maxResidualCurrent}\n          yMin={0}\n          xMin={xMin}\n          xMax={xMax}\n          mouseX={mouseX}\n          onMouseMove={onMouseMove}\n          onMouseOut={onMouseOut}\n          onWheel={onWheel}\n        />\n        <div className={styles.labels}>\n          <Labels\n            timestamp={nearest.timestamp}\n            labels={checkedDevices.map(device => ({\n              id: device.id,\n              color: colors[device.id],\n              value: `${get(nearest.residualCurrent, [device.id], 0)} mA`,\n            }))}\n          />\n        </div>\n      </div>\n    </div>\n  )\n}\n\nInverterGraphs.propTypes = {\n  graphWidth: PropTypes.number.isRequired,\n  plantId: PropTypes.string.isRequired,\n  devices: PropTypes.arrayOf(\n    PropTypes.shape({\n      model: PropTypes.string.isRequired,\n      id: PropTypes.string.isRequired,\n    })\n  ).isRequired,\n  disableScroll: PropTypes.func.isRequired,\n  enableScroll: PropTypes.func.isRequired,\n}\n\nasync function getLogs(params, props) {\n  const { plantId, deviceIds, xMin, xMax } = params\n\n  const gte = new Date(xMin * 1000).toISOString()\n  const lte = new Date(xMax * 1000).toISOString()\n  const step = 5\n\n  const res = await Promise.all(\n    deviceIds.map(async deviceId => {\n      const data = await api.getLogs({\n        plantId,\n        deviceId,\n        gte,\n        lte,\n        step,\n      })\n\n      return {\n        deviceId,\n        data,\n      }\n    })\n  )\n\n  const unixTimes = get(res, [0, \"data\"], []).map(({ unixTime }) => unixTime)\n\n  let maxPower = 0\n  let maxCurrent = 0\n  let maxVoltage = 0\n  let maxInsulationResistance = 0\n  let maxResidualCurrent = 0\n\n  const logs = {}\n\n  for (const { deviceId, data } of res) {\n    logs[deviceId] = {\n      power: [],\n      current: [],\n      voltage: [],\n      insulationResistance: [],\n      residualCurrent: [],\n    }\n\n    for (const d of data) {\n      logs[deviceId].power.push({\n        x: d.unixTime,\n        y: d.power,\n      })\n\n      logs[deviceId].current.push({\n        x: d.unixTime,\n        y: d.current,\n      })\n\n      logs[deviceId].voltage.push({\n        x: d.unixTime,\n        y: d.voltage,\n      })\n\n      logs[deviceId].insulationResistance.push({\n        x: d.unixTime,\n        y: d.insulationResistance,\n      })\n\n      logs[deviceId].residualCurrent.push({\n        x: d.unixTime,\n        y: d.residualCurrent,\n      })\n\n      maxPower = Math.max(d.power, maxPower)\n      maxCurrent = Math.max(d.current, maxCurrent)\n      maxVoltage = Math.max(d.voltage, maxVoltage)\n      maxInsulationResistance = Math.max(\n        d.insulationResistance,\n        maxInsulationResistance\n      )\n      maxResidualCurrent = Math.max(d.residualCurrent, maxResidualCurrent)\n    }\n  }\n\n  return {\n    maxPower,\n    maxCurrent,\n    maxVoltage,\n    maxInsulationResistance,\n    maxResidualCurrent,\n    logs,\n    unixTimes,\n  }\n}\n\nexport default compose(\n  connect(state => ({ divSize: state.divSize })),\n  disableScroll,\n  withParams({\n    xMin: X_MIN,\n    xMax: X_MAX,\n  }),\n  withFetch(getLogs, {\n    name: \"getLogs\",\n    getFetchId: (name, params) => `${name}-${params.plantId}`,\n    debounce: 500,\n    getParams: props => ({\n      plantId: props.plantId,\n      deviceIds: props.devices.map(({ id }) => id),\n      xMin: props.params.xMin,\n      xMax: props.params.xMax,\n    }),\n    saveCache: (props, response) => {},\n    shouldFetch: (props, repsonse, params) => true,\n  })\n)(InverterGraphs)\n","import React from \"react\"\nimport PropTypes from \"prop-types\"\nimport { connect } from \"react-redux\"\nimport { get, compose } from \"../../util\"\nimport * as api from \"../../api\"\nimport COLORS from \"../../lib/colors\"\nimport { bound } from \"../../util/math\"\nimport withFetch from \"../../components/withFetch\"\nimport Loading from \"../../components/Loading\"\nimport styles from \"./index.module.css\"\nimport EnergyGraph from \"./EnergyGraph\"\nimport InverterGraphs from \"./InverterGraphs\"\n\nconst GRAPH_PADDING = 10\nconst MIN_GRAPH_WIDTH = 300\nconst MAX_GRAPH_WIDTH = 1200\n\nexport function PowerPlantDetailPage(props) {\n  const { divSize, getPowerPlant } = props\n\n  const devices = get(getPowerPlant, [\"response\", \"devices\"], [])\n\n  const colors = devices.reduce((colors, device, i) => {\n    colors[device.id] = COLORS[i]\n    return colors\n  }, {})\n\n  const graphWidth = bound(\n    divSize.width - 2 * GRAPH_PADDING,\n    MIN_GRAPH_WIDTH,\n    MAX_GRAPH_WIDTH\n  )\n\n  // TODO only render graph when new data\n  // TODO stacked bar graph\n  // TODO filter graph by date\n  return (\n    <div>\n      <div className={styles.header}>\n        <div className={styles.headerText}>\n          Plant {props.match.params.plantId}\n        </div>\n        <div className={styles.subHeader}>{devices.length} devices</div>\n      </div>\n      <Loading\n        loading={getPowerPlant.fetching || !getPowerPlant.fetchedAt}\n        error={getPowerPlant.error}\n        onClickRetry={getPowerPlant.fetch}\n      >\n        {devices.length > 0 && (\n          <>\n            <EnergyGraph\n              plantId={props.match.params.plantId}\n              devices={devices}\n              graphWidth={graphWidth}\n              colors={colors}\n            />\n            <InverterGraphs\n              plantId={props.match.params.plantId}\n              devices={devices.filter(\n                device => device.model != \"Cluster Controller\"\n              )}\n              graphWidth={graphWidth}\n              colors={colors}\n            />\n          </>\n        )}\n      </Loading>\n    </div>\n  )\n}\n\nPowerPlantDetailPage.propTypes = {\n  match: PropTypes.shape({\n    params: PropTypes.shape({\n      plantId: PropTypes.string.isRequired,\n    }).isRequired,\n  }).isRequired,\n  divSize: PropTypes.shape({\n    width: PropTypes.number.isRequired,\n    height: PropTypes.number.isRequired,\n  }).isRequired,\n  getPowerPlant: PropTypes.shape({\n    response: PropTypes.shape({\n      devices: PropTypes.array.isRequired,\n    }),\n    error: PropTypes.string.isRequired,\n    fetching: PropTypes.bool.isRequired,\n    fetch: PropTypes.func.isRequired,\n    fetchedAt: PropTypes.string.isRequired,\n  }).isRequired,\n}\n\nexport default compose(\n  connect(state => ({ divSize: state.divSize })),\n  withFetch(params => api.getPowerPlant(params), {\n    name: \"getPowerPlant\",\n    getFetchId: (name, params) => `${name}-${params.id}`,\n    getParams: props => ({ id: props.match.params.plantId }),\n    shouldFetch: (props, response) => !response,\n  })\n)(PowerPlantDetailPage)\n","import React from \"react\"\nimport { Route, Switch } from \"react-router-dom\"\nimport styles from \"./App.module.css\"\nimport withDivSize from \"./components/withDivSize\"\nimport HomePage from \"./pages/HomePage\"\nimport PowerPlantDetailPage from \"./pages/PowerPlantDetailPage\"\n\nexport function App() {\n  return (\n    <div className={styles.component}>\n      <h5>Time zone: {process.env.REACT_APP_TIME_ZONE}</h5>\n\n      <Switch>\n        <Route path=\"/plants/:plantId\" component={PowerPlantDetailPage} />\n        <Route component={HomePage} />\n      </Switch>\n\n      <div className={styles.footer} />\n    </div>\n  )\n}\n\nexport default withDivSize(App)\n","import React, { useEffect, useRef } from \"react\"\nimport PropTypes from \"prop-types\"\nimport { connect } from \"react-redux\"\nimport { actions } from \"../reducer\"\n\nexport default function withDivSize(Component) {\n  function WithDivSize(props) {\n    const ref = useRef()\n\n    useEffect(() => {\n      function setDivSize() {\n        props.updateDivSize({\n          // size of div\n          height: ref.current.clientHeight,\n          width: ref.current.clientWidth,\n        })\n      }\n\n      setDivSize()\n\n      window.addEventListener(\"resize\", setDivSize)\n\n      return () => {\n        window.removeEventListener(\"resize\", setDivSize)\n      }\n    }, [])\n\n    return (\n      <div ref={ref}>\n        <Component {...props} />\n      </div>\n    )\n  }\n\n  WithDivSize.propTypes = {\n    updateDivSize: PropTypes.func.isRequired,\n  }\n\n  return connect(\n    undefined,\n    actions.divSize\n  )(WithDivSize)\n}\n","// This optional code is used to register a service worker.\n// register() is not called by default.\n\n// This lets the app load faster on subsequent visits in production, and gives\n// it offline capabilities. However, it also means that developers (and users)\n// will only see deployed updates on subsequent visits to a page, after all the\n// existing tabs open on the page have been closed, since previously cached\n// resources are updated in the background.\n\n// To learn more about the benefits of this model and instructions on how to\n// opt-in, read https://bit.ly/CRA-PWA\n\nconst isLocalhost = Boolean(\n  window.location.hostname === 'localhost' ||\n    // [::1] is the IPv6 localhost address.\n    window.location.hostname === '[::1]' ||\n    // 127.0.0.1/8 is considered localhost for IPv4.\n    window.location.hostname.match(\n      /^127(?:\\.(?:25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)){3}$/\n    )\n);\n\nexport function register(config) {\n  if (process.env.NODE_ENV === 'production' && 'serviceWorker' in navigator) {\n    // The URL constructor is available in all browsers that support SW.\n    const publicUrl = new URL(process.env.PUBLIC_URL, window.location.href);\n    if (publicUrl.origin !== window.location.origin) {\n      // Our service worker won't work if PUBLIC_URL is on a different origin\n      // from what our page is served on. This might happen if a CDN is used to\n      // serve assets; see https://github.com/facebook/create-react-app/issues/2374\n      return;\n    }\n\n    window.addEventListener('load', () => {\n      const swUrl = `${process.env.PUBLIC_URL}/service-worker.js`;\n\n      if (isLocalhost) {\n        // This is running on localhost. Let's check if a service worker still exists or not.\n        checkValidServiceWorker(swUrl, config);\n\n        // Add some additional logging to localhost, pointing developers to the\n        // service worker/PWA documentation.\n        navigator.serviceWorker.ready.then(() => {\n          console.log(\n            'This web app is being served cache-first by a service ' +\n              'worker. To learn more, visit https://bit.ly/CRA-PWA'\n          );\n        });\n      } else {\n        // Is not localhost. Just register service worker\n        registerValidSW(swUrl, config);\n      }\n    });\n  }\n}\n\nfunction registerValidSW(swUrl, config) {\n  navigator.serviceWorker\n    .register(swUrl)\n    .then(registration => {\n      registration.onupdatefound = () => {\n        const installingWorker = registration.installing;\n        if (installingWorker == null) {\n          return;\n        }\n        installingWorker.onstatechange = () => {\n          if (installingWorker.state === 'installed') {\n            if (navigator.serviceWorker.controller) {\n              // At this point, the updated precached content has been fetched,\n              // but the previous service worker will still serve the older\n              // content until all client tabs are closed.\n              console.log(\n                'New content is available and will be used when all ' +\n                  'tabs for this page are closed. See https://bit.ly/CRA-PWA.'\n              );\n\n              // Execute callback\n              if (config && config.onUpdate) {\n                config.onUpdate(registration);\n              }\n            } else {\n              // At this point, everything has been precached.\n              // It's the perfect time to display a\n              // \"Content is cached for offline use.\" message.\n              console.log('Content is cached for offline use.');\n\n              // Execute callback\n              if (config && config.onSuccess) {\n                config.onSuccess(registration);\n              }\n            }\n          }\n        };\n      };\n    })\n    .catch(error => {\n      console.error('Error during service worker registration:', error);\n    });\n}\n\nfunction checkValidServiceWorker(swUrl, config) {\n  // Check if the service worker can be found. If it can't reload the page.\n  fetch(swUrl)\n    .then(response => {\n      // Ensure service worker exists, and that we really are getting a JS file.\n      const contentType = response.headers.get('content-type');\n      if (\n        response.status === 404 ||\n        (contentType != null && contentType.indexOf('javascript') === -1)\n      ) {\n        // No service worker found. Probably a different app. Reload the page.\n        navigator.serviceWorker.ready.then(registration => {\n          registration.unregister().then(() => {\n            window.location.reload();\n          });\n        });\n      } else {\n        // Service worker found. Proceed as normal.\n        registerValidSW(swUrl, config);\n      }\n    })\n    .catch(() => {\n      console.log(\n        'No internet connection found. App is running in offline mode.'\n      );\n    });\n}\n\nexport function unregister() {\n  if ('serviceWorker' in navigator) {\n    navigator.serviceWorker.ready.then(registration => {\n      registration.unregister();\n    });\n  }\n}\n","import React from \"react\"\nimport ReactDOM from \"react-dom\"\nimport \"semantic-ui-css/semantic.min.css\"\nimport \"./index.css\"\nimport App from \"./App\"\nimport * as serviceWorker from \"./serviceWorker\"\nimport { BrowserRouter as Router } from \"react-router-dom\"\n\n// redux\nimport { applyMiddleware, createStore } from \"redux\"\nimport { Provider } from \"react-redux\"\nimport thunk from \"redux-thunk\"\nimport logger from \"redux-logger\"\nimport { reducer } from \"./reducer\"\n\nlet middlewares = [thunk]\nif (process.env.NODE_ENV !== \"production\") {\n  middlewares.push(logger)\n}\n\nconst store = createStore(reducer, applyMiddleware(...middlewares))\n\nReactDOM.render(\n  <Router basename={process.env.PUBLIC_URL}>\n    <Provider store={store}>\n      <App />\n    </Provider>\n  </Router>,\n  document.getElementById(\"root\")\n)\n\n// If you want your app to work offline and load faster, you can change\n// unregister() to register() below. Note this comes with some pitfalls.\n// Learn more about service workers: https://bit.ly/CRA-PWA\nserviceWorker.unregister()\n","// extracted by mini-css-extract-plugin\nmodule.exports = {\"stats\":\"FiscalEnergyGraph_stats__3j2T_\",\"month\":\"FiscalEnergyGraph_month__1qsdS\",\"number\":\"FiscalEnergyGraph_number__3ViBk\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"count\":\"HomePage_count__3Q6q8\",\"col\":\"HomePage_col__33bFf\",\"row\":\"HomePage_row__i7JCH\",\"plantHeader\":\"HomePage_plantHeader__26-Kz\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"header\":\"PowerPlantDetailPage_header__2Oy6X\",\"headerText\":\"PowerPlantDetailPage_headerText__3xQIM\",\"subHeader\":\"PowerPlantDetailPage_subHeader__4shvN\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"filter\":\"EnergyGraph_filter__sXpE0\",\"filterCol\":\"EnergyGraph_filterCol__3lRs-\"};","// extracted by mini-css-extract-plugin\nmodule.exports = {\"timestamp\":\"Labels_timestamp__14xTO\",\"labels\":\"Labels_labels__3OjBJ\",\"label\":\"Labels_label__3jxsh\"};"],"sourceRoot":""}